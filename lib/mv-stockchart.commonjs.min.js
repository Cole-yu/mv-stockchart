!function(){"use strict";var t={1216:function(t,i,e){var n=e(1051),s=e(7674),o=TypeError;t.exports=function(t){if(n(t))return t;throw new o(s(t)+" is not a function")}},993:function(t,i,e){var n=e(1051),s=String,o=TypeError;t.exports=function(t){if("object"==typeof t||n(t))return t;throw new o("Can't set "+s(t)+" as a prototype")}},5278:function(t,i,e){var n=e(4525),s=e(4123),o=e(7567).f,a=n("unscopables"),h=Array.prototype;void 0===h[a]&&o(h,a,{configurable:!0,value:s(null)}),t.exports=function(t){h[a][t]=!0}},8808:function(t,i,e){var n=e(1409).charAt;t.exports=function(t,i,e){return i+(e?n(t,i).length:1)}},7033:function(t,i,e){var n=e(1203),s=String,o=TypeError;t.exports=function(t){if(n(t))return t;throw new o(s(t)+" is not an object")}},7156:function(t,i,e){var n=e(2235),s=e(655),o=e(8109),a=function(t){return function(i,e,a){var h,r=n(i),c=o(r),l=s(a,c);if(t&&e!=e){for(;c>l;)if((h=r[l++])!=h)return!0}else for(;c>l;l++)if((t||l in r)&&r[l]===e)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},7850:function(t,i,e){var n=e(3930),s=n({}.toString),o=n("".slice);t.exports=function(t){return o(s(t),8,-1)}},3242:function(t,i,e){var n=e(8049),s=e(1051),o=e(7850),a=e(4525)("toStringTag"),h=Object,r="Arguments"===o(function(){return arguments}());t.exports=n?o:function(t){var i,e,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,i){try{return t[i]}catch(t){}}(i=h(t),a))?e:r?o(i):"Object"===(n=o(i))&&s(i.callee)?"Arguments":n}},4838:function(t,i,e){var n=e(4592),s=e(3753),o=e(2888),a=e(7567);t.exports=function(t,i,e){for(var h=s(i),r=a.f,c=o.f,l=0;l<h.length;l++){var d=h[l];n(t,d)||e&&n(e,d)||r(t,d,c(i,d))}}},6366:function(t,i,e){var n=e(6261);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},3988:function(t){t.exports=function(t,i){return{value:t,done:i}}},7917:function(t,i,e){var n=e(7233),s=e(7567),o=e(5711);t.exports=n?function(t,i,e){return s.f(t,i,o(1,e))}:function(t,i,e){return t[i]=e,t}},5711:function(t){t.exports=function(t,i){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:i}}},6511:function(t,i,e){var n=e(1051),s=e(7567),o=e(9107),a=e(9883);t.exports=function(t,i,e,h){h||(h={});var r=h.enumerable,c=void 0!==h.name?h.name:i;if(n(e)&&o(e,c,h),h.global)r?t[i]=e:a(i,e);else{try{h.unsafe?t[i]&&(r=!0):delete t[i]}catch(t){}r?t[i]=e:s.f(t,i,{value:e,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return t}},9883:function(t,i,e){var n=e(8386),s=Object.defineProperty;t.exports=function(t,i){try{s(n,t,{value:i,configurable:!0,writable:!0})}catch(e){n[t]=i}return i}},7233:function(t,i,e){var n=e(6261);t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},5955:function(t){var i="object"==typeof document&&document.all,e=void 0===i&&void 0!==i;t.exports={all:i,IS_HTMLDDA:e}},4995:function(t,i,e){var n=e(8386),s=e(1203),o=n.document,a=s(o)&&s(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},884:function(t){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},4739:function(t,i,e){var n=e(4995)("span").classList,s=n&&n.constructor&&n.constructor.prototype;t.exports=s===Object.prototype?void 0:s},6715:function(t){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},293:function(t,i,e){var n,s,o=e(8386),a=e(6715),h=o.process,r=o.Deno,c=h&&h.versions||r&&r.version,l=c&&c.v8;l&&(s=(n=l.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!s&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(s=+n[1]),t.exports=s},288:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6589:function(t,i,e){var n=e(8386),s=e(2888).f,o=e(7917),a=e(6511),h=e(9883),r=e(4838),c=e(6463);t.exports=function(t,i){var e,l,d,u,p,f=t.target,m=t.global,g=t.stat;if(e=m?n:g?n[f]||h(f,{}):(n[f]||{}).prototype)for(l in i){if(u=i[l],d=t.dontCallGetSet?(p=s(e,l))&&p.value:e[l],!c(m?l:f+(g?".":"#")+l,t.forced)&&void 0!==d){if(typeof u==typeof d)continue;r(u,d)}(t.sham||d&&d.sham)&&o(u,"sham",!0),a(e,l,u,t)}}},6261:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},4562:function(t,i,e){e(1011);var n=e(641),s=e(6511),o=e(5317),a=e(6261),h=e(4525),r=e(7917),c=h("species"),l=RegExp.prototype;t.exports=function(t,i,e,d){var u=h(t),p=!a((function(){var i={};return i[u]=function(){return 7},7!==""[t](i)})),f=p&&!a((function(){var i=!1,e=/a/;return"split"===t&&((e={}).constructor={},e.constructor[c]=function(){return e},e.flags="",e[u]=/./[u]),e.exec=function(){return i=!0,null},e[u](""),!i}));if(!p||!f||e){var m=n(/./[u]),g=i(u,""[t],(function(t,i,e,s,a){var h=n(t),r=i.exec;return r===o||r===l.exec?p&&!a?{done:!0,value:m(i,e,s)}:{done:!0,value:h(e,i,s)}:{done:!1}}));s(String.prototype,t,g[0]),s(l,u,g[1])}d&&r(l[u],"sham",!0)}},7987:function(t,i,e){var n=e(366),s=Function.prototype,o=s.apply,a=s.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(o):function(){return a.apply(o,arguments)})},366:function(t,i,e){var n=e(6261);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},8789:function(t,i,e){var n=e(366),s=Function.prototype.call;t.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},5832:function(t,i,e){var n=e(7233),s=e(4592),o=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,h=s(o,"name"),r=h&&"something"===function(){}.name,c=h&&(!n||n&&a(o,"name").configurable);t.exports={EXISTS:h,PROPER:r,CONFIGURABLE:c}},4447:function(t,i,e){var n=e(3930),s=e(1216);t.exports=function(t,i,e){try{return n(s(Object.getOwnPropertyDescriptor(t,i)[e]))}catch(t){}}},641:function(t,i,e){var n=e(7850),s=e(3930);t.exports=function(t){if("Function"===n(t))return s(t)}},3930:function(t,i,e){var n=e(366),s=Function.prototype,o=s.call,a=n&&s.bind.bind(o,o);t.exports=n?a:function(t){return function(){return o.apply(t,arguments)}}},521:function(t,i,e){var n=e(8386),s=e(1051);t.exports=function(t,i){return arguments.length<2?(e=n[t],s(e)?e:void 0):n[t]&&n[t][i];var e}},8285:function(t,i,e){var n=e(1216),s=e(5582);t.exports=function(t,i){var e=t[i];return s(e)?void 0:n(e)}},9267:function(t,i,e){var n=e(3930),s=e(1953),o=Math.floor,a=n("".charAt),h=n("".replace),r=n("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,i,e,n,d,u){var p=e+t.length,f=n.length,m=l;return void 0!==d&&(d=s(d),m=c),h(u,m,(function(s,h){var c;switch(a(h,0)){case"$":return"$";case"&":return t;case"`":return r(i,0,e);case"'":return r(i,p);case"<":c=d[r(h,1,-1)];break;default:var l=+h;if(0===l)return s;if(l>f){var u=o(l/10);return 0===u?s:u<=f?void 0===n[u-1]?a(h,1):n[u-1]+a(h,1):s}c=n[l-1]}return void 0===c?"":c}))}},8386:function(t,i,e){var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e.g&&e.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4592:function(t,i,e){var n=e(3930),s=e(1953),o=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,i){return o(s(t),i)}},2164:function(t){t.exports={}},6592:function(t,i,e){var n=e(521);t.exports=n("document","documentElement")},5304:function(t,i,e){var n=e(7233),s=e(6261),o=e(4995);t.exports=!n&&!s((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},9984:function(t,i,e){var n=e(3930),s=e(6261),o=e(7850),a=Object,h=n("".split);t.exports=s((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?h(t,""):a(t)}:a},8840:function(t,i,e){var n=e(3930),s=e(1051),o=e(9304),a=n(Function.toString);s(o.inspectSource)||(o.inspectSource=function(t){return a(t)}),t.exports=o.inspectSource},2657:function(t,i,e){var n,s,o,a=e(6084),h=e(8386),r=e(1203),c=e(7917),l=e(4592),d=e(9304),u=e(1004),p=e(2164),f="Object already initialized",m=h.TypeError,g=h.WeakMap;if(a||d.state){var v=d.state||(d.state=new g);v.get=v.get,v.has=v.has,v.set=v.set,n=function(t,i){if(v.has(t))throw new m(f);return i.facade=t,v.set(t,i),i},s=function(t){return v.get(t)||{}},o=function(t){return v.has(t)}}else{var C=u("state");p[C]=!0,n=function(t,i){if(l(t,C))throw new m(f);return i.facade=t,c(t,C,i),i},s=function(t){return l(t,C)?t[C]:{}},o=function(t){return l(t,C)}}t.exports={set:n,get:s,has:o,enforce:function(t){return o(t)?s(t):n(t,{})},getterFor:function(t){return function(i){var e;if(!r(i)||(e=s(i)).type!==t)throw new m("Incompatible receiver, "+t+" required");return e}}}},1051:function(t,i,e){var n=e(5955),s=n.all;t.exports=n.IS_HTMLDDA?function(t){return"function"==typeof t||t===s}:function(t){return"function"==typeof t}},6463:function(t,i,e){var n=e(6261),s=e(1051),o=/#|\.prototype\./,a=function(t,i){var e=r[h(t)];return e===l||e!==c&&(s(i)?n(i):!!i)},h=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},r=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";t.exports=a},5582:function(t){t.exports=function(t){return null==t}},1203:function(t,i,e){var n=e(1051),s=e(5955),o=s.all;t.exports=s.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:n(t)||t===o}:function(t){return"object"==typeof t?null!==t:n(t)}},1876:function(t){t.exports=!1},9934:function(t,i,e){var n=e(521),s=e(1051),o=e(9479),a=e(2806),h=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var i=n("Symbol");return s(i)&&o(i.prototype,h(t))}},2388:function(t,i,e){var n=e(1558).IteratorPrototype,s=e(4123),o=e(5711),a=e(4807),h=e(4782),r=function(){return this};t.exports=function(t,i,e,c){var l=i+" Iterator";return t.prototype=s(n,{next:o(+!c,e)}),a(t,l,!1,!0),h[l]=r,t}},2482:function(t,i,e){var n=e(6589),s=e(8789),o=e(1876),a=e(5832),h=e(1051),r=e(2388),c=e(3587),l=e(4205),d=e(4807),u=e(7917),p=e(6511),f=e(4525),m=e(4782),g=e(1558),v=a.PROPER,C=a.CONFIGURABLE,x=g.IteratorPrototype,b=g.BUGGY_SAFARI_ITERATORS,y=f("iterator"),w="keys",S="values",P="entries",L=function(){return this};t.exports=function(t,i,e,a,f,g,T){r(e,i,a);var M,k,J,E=function(t){if(t===f&&O)return O;if(!b&&t&&t in D)return D[t];switch(t){case w:case S:case P:return function(){return new e(this,t)}}return function(){return new e(this)}},I=i+" Iterator",A=!1,D=t.prototype,R=D[y]||D["@@iterator"]||f&&D[f],O=!b&&R||E(f),F="Array"===i&&D.entries||R;if(F&&(M=c(F.call(new t)))!==Object.prototype&&M.next&&(o||c(M)===x||(l?l(M,x):h(M[y])||p(M,y,L)),d(M,I,!0,!0),o&&(m[I]=L)),v&&f===S&&R&&R.name!==S&&(!o&&C?u(D,"name",S):(A=!0,O=function(){return s(R,this)})),f)if(k={values:E(S),keys:g?O:E(w),entries:E(P)},T)for(J in k)(b||A||!(J in D))&&p(D,J,k[J]);else n({target:i,proto:!0,forced:b||A},k);return o&&!T||D[y]===O||p(D,y,O,{name:f}),m[i]=O,k}},1558:function(t,i,e){var n,s,o,a=e(6261),h=e(1051),r=e(1203),c=e(4123),l=e(3587),d=e(6511),u=e(4525),p=e(1876),f=u("iterator"),m=!1;[].keys&&("next"in(o=[].keys())?(s=l(l(o)))!==Object.prototype&&(n=s):m=!0),!r(n)||a((function(){var t={};return n[f].call(t)!==t}))?n={}:p&&(n=c(n)),h(n[f])||d(n,f,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:m}},4782:function(t){t.exports={}},8109:function(t,i,e){var n=e(6177);t.exports=function(t){return n(t.length)}},9107:function(t,i,e){var n=e(3930),s=e(6261),o=e(1051),a=e(4592),h=e(7233),r=e(5832).CONFIGURABLE,c=e(8840),l=e(2657),d=l.enforce,u=l.get,p=String,f=Object.defineProperty,m=n("".slice),g=n("".replace),v=n([].join),C=h&&!s((function(){return 8!==f((function(){}),"length",{value:8}).length})),x=String(String).split("String"),b=t.exports=function(t,i,e){"Symbol("===m(p(i),0,7)&&(i="["+g(p(i),/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(i="get "+i),e&&e.setter&&(i="set "+i),(!a(t,"name")||r&&t.name!==i)&&(h?f(t,"name",{value:i,configurable:!0}):t.name=i),C&&e&&a(e,"arity")&&t.length!==e.arity&&f(t,"length",{value:e.arity});try{e&&a(e,"constructor")&&e.constructor?h&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=d(t);return a(n,"source")||(n.source=v(x,"string"==typeof i?i:"")),t};Function.prototype.toString=b((function(){return o(this)&&u(this).source||c(this)}),"toString")},1108:function(t){var i=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:i)(n)}},4123:function(t,i,e){var n,s=e(7033),o=e(8610),a=e(288),h=e(2164),r=e(6592),c=e(4995),l=e(1004),d="prototype",u="script",p=l("IE_PROTO"),f=function(){},m=function(t){return"<"+u+">"+t+"</"+u+">"},g=function(t){t.write(m("")),t.close();var i=t.parentWindow.Object;return t=null,i},v=function(){try{n=new ActiveXObject("htmlfile")}catch(t){}var t,i,e;v="undefined"!=typeof document?document.domain&&n?g(n):(i=c("iframe"),e="java"+u+":",i.style.display="none",r.appendChild(i),i.src=String(e),(t=i.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F):g(n);for(var s=a.length;s--;)delete v[d][a[s]];return v()};h[p]=!0,t.exports=Object.create||function(t,i){var e;return null!==t?(f[d]=s(t),e=new f,f[d]=null,e[p]=t):e=v(),void 0===i?e:o.f(e,i)}},8610:function(t,i,e){var n=e(7233),s=e(9850),o=e(7567),a=e(7033),h=e(2235),r=e(1725);i.f=n&&!s?Object.defineProperties:function(t,i){a(t);for(var e,n=h(i),s=r(i),c=s.length,l=0;c>l;)o.f(t,e=s[l++],n[e]);return t}},7567:function(t,i,e){var n=e(7233),s=e(5304),o=e(9850),a=e(7033),h=e(5612),r=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d="enumerable",u="configurable",p="writable";i.f=n?o?function(t,i,e){if(a(t),i=h(i),a(e),"function"==typeof t&&"prototype"===i&&"value"in e&&p in e&&!e[p]){var n=l(t,i);n&&n[p]&&(t[i]=e.value,e={configurable:u in e?e[u]:n[u],enumerable:d in e?e[d]:n[d],writable:!1})}return c(t,i,e)}:c:function(t,i,e){if(a(t),i=h(i),a(e),s)try{return c(t,i,e)}catch(t){}if("get"in e||"set"in e)throw new r("Accessors not supported");return"value"in e&&(t[i]=e.value),t}},2888:function(t,i,e){var n=e(7233),s=e(8789),o=e(6737),a=e(5711),h=e(2235),r=e(5612),c=e(4592),l=e(5304),d=Object.getOwnPropertyDescriptor;i.f=n?d:function(t,i){if(t=h(t),i=r(i),l)try{return d(t,i)}catch(t){}if(c(t,i))return a(!s(o.f,t,i),t[i])}},6153:function(t,i,e){var n=e(6474),s=e(288).concat("length","prototype");i.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},3998:function(t,i){i.f=Object.getOwnPropertySymbols},3587:function(t,i,e){var n=e(4592),s=e(1051),o=e(1953),a=e(1004),h=e(6366),r=a("IE_PROTO"),c=Object,l=c.prototype;t.exports=h?c.getPrototypeOf:function(t){var i=o(t);if(n(i,r))return i[r];var e=i.constructor;return s(e)&&i instanceof e?e.prototype:i instanceof c?l:null}},9479:function(t,i,e){var n=e(3930);t.exports=n({}.isPrototypeOf)},6474:function(t,i,e){var n=e(3930),s=e(4592),o=e(2235),a=e(7156).indexOf,h=e(2164),r=n([].push);t.exports=function(t,i){var e,n=o(t),c=0,l=[];for(e in n)!s(h,e)&&s(n,e)&&r(l,e);for(;i.length>c;)s(n,e=i[c++])&&(~a(l,e)||r(l,e));return l}},1725:function(t,i,e){var n=e(6474),s=e(288);t.exports=Object.keys||function(t){return n(t,s)}},6737:function(t,i){var e={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!e.call({1:2},1);i.f=s?function(t){var i=n(this,t);return!!i&&i.enumerable}:e},4205:function(t,i,e){var n=e(4447),s=e(7033),o=e(993);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,i=!1,e={};try{(t=n(Object.prototype,"__proto__","set"))(e,[]),i=e instanceof Array}catch(t){}return function(e,n){return s(e),o(n),i?t(e,n):e.__proto__=n,e}}():void 0)},3402:function(t,i,e){var n=e(8789),s=e(1051),o=e(1203),a=TypeError;t.exports=function(t,i){var e,h;if("string"===i&&s(e=t.toString)&&!o(h=n(e,t)))return h;if(s(e=t.valueOf)&&!o(h=n(e,t)))return h;if("string"!==i&&s(e=t.toString)&&!o(h=n(e,t)))return h;throw new a("Can't convert object to primitive value")}},3753:function(t,i,e){var n=e(521),s=e(3930),o=e(6153),a=e(3998),h=e(7033),r=s([].concat);t.exports=n("Reflect","ownKeys")||function(t){var i=o.f(h(t)),e=a.f;return e?r(i,e(t)):i}},9786:function(t,i,e){var n=e(8789),s=e(7033),o=e(1051),a=e(7850),h=e(5317),r=TypeError;t.exports=function(t,i){var e=t.exec;if(o(e)){var c=n(e,t,i);return null!==c&&s(c),c}if("RegExp"===a(t))return n(h,t,i);throw new r("RegExp#exec called on incompatible receiver")}},5317:function(t,i,e){var n,s,o=e(8789),a=e(3930),h=e(6516),r=e(9780),c=e(8027),l=e(8688),d=e(4123),u=e(2657).get,p=e(6124),f=e(2437),m=l("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,v=g,C=a("".charAt),x=a("".indexOf),b=a("".replace),y=a("".slice),w=(s=/b*/g,o(g,n=/a/,"a"),o(g,s,"a"),0!==n.lastIndex||0!==s.lastIndex),S=c.BROKEN_CARET,P=void 0!==/()??/.exec("")[1];(w||P||S||p||f)&&(v=function(t){var i,e,n,s,a,c,l,p=this,f=u(p),L=h(t),T=f.raw;if(T)return T.lastIndex=p.lastIndex,i=o(v,T,L),p.lastIndex=T.lastIndex,i;var M=f.groups,k=S&&p.sticky,J=o(r,p),E=p.source,I=0,A=L;if(k&&(J=b(J,"y",""),-1===x(J,"g")&&(J+="g"),A=y(L,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==C(L,p.lastIndex-1))&&(E="(?: "+E+")",A=" "+A,I++),e=new RegExp("^(?:"+E+")",J)),P&&(e=new RegExp("^"+E+"$(?!\\s)",J)),w&&(n=p.lastIndex),s=o(g,k?e:p,A),k?s?(s.input=y(s.input,I),s[0]=y(s[0],I),s.index=p.lastIndex,p.lastIndex+=s[0].length):p.lastIndex=0:w&&s&&(p.lastIndex=p.global?s.index+s[0].length:n),P&&s&&s.length>1&&o(m,s[0],e,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(s[a]=void 0)})),s&&M)for(s.groups=c=d(null),a=0;a<M.length;a++)c[(l=M[a])[0]]=s[l[1]];return s}),t.exports=v},9780:function(t,i,e){var n=e(7033);t.exports=function(){var t=n(this),i="";return t.hasIndices&&(i+="d"),t.global&&(i+="g"),t.ignoreCase&&(i+="i"),t.multiline&&(i+="m"),t.dotAll&&(i+="s"),t.unicode&&(i+="u"),t.unicodeSets&&(i+="v"),t.sticky&&(i+="y"),i}},8027:function(t,i,e){var n=e(6261),s=e(8386).RegExp,o=n((function(){var t=s("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),a=o||n((function(){return!s("a","y").sticky})),h=o||n((function(){var t=s("^r","gy");return t.lastIndex=2,null!==t.exec("str")}));t.exports={BROKEN_CARET:h,MISSED_STICKY:a,UNSUPPORTED_Y:o}},6124:function(t,i,e){var n=e(6261),s=e(8386).RegExp;t.exports=n((function(){var t=s(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)}))},2437:function(t,i,e){var n=e(6261),s=e(8386).RegExp;t.exports=n((function(){var t=s("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},1628:function(t,i,e){var n=e(5582),s=TypeError;t.exports=function(t){if(n(t))throw new s("Can't call method on "+t);return t}},4807:function(t,i,e){var n=e(7567).f,s=e(4592),o=e(4525)("toStringTag");t.exports=function(t,i,e){t&&!e&&(t=t.prototype),t&&!s(t,o)&&n(t,o,{configurable:!0,value:i})}},1004:function(t,i,e){var n=e(8688),s=e(6482),o=n("keys");t.exports=function(t){return o[t]||(o[t]=s(t))}},9304:function(t,i,e){var n=e(8386),s=e(9883),o="__core-js_shared__",a=n[o]||s(o,{});t.exports=a},8688:function(t,i,e){var n=e(1876),s=e(9304);(t.exports=function(t,i){return s[t]||(s[t]=void 0!==i?i:{})})("versions",[]).push({version:"3.34.0",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"})},1409:function(t,i,e){var n=e(3930),s=e(5342),o=e(6516),a=e(1628),h=n("".charAt),r=n("".charCodeAt),c=n("".slice),l=function(t){return function(i,e){var n,l,d=o(a(i)),u=s(e),p=d.length;return u<0||u>=p?t?"":void 0:(n=r(d,u))<55296||n>56319||u+1===p||(l=r(d,u+1))<56320||l>57343?t?h(d,u):n:t?c(d,u,u+2):l-56320+(n-55296<<10)+65536}};t.exports={codeAt:l(!1),charAt:l(!0)}},3293:function(t,i,e){var n=e(293),s=e(6261),o=e(8386).String;t.exports=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},655:function(t,i,e){var n=e(5342),s=Math.max,o=Math.min;t.exports=function(t,i){var e=n(t);return e<0?s(e+i,0):o(e,i)}},2235:function(t,i,e){var n=e(9984),s=e(1628);t.exports=function(t){return n(s(t))}},5342:function(t,i,e){var n=e(1108);t.exports=function(t){var i=+t;return i!=i||0===i?0:n(i)}},6177:function(t,i,e){var n=e(5342),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},1953:function(t,i,e){var n=e(1628),s=Object;t.exports=function(t){return s(n(t))}},9022:function(t,i,e){var n=e(8789),s=e(1203),o=e(9934),a=e(8285),h=e(3402),r=e(4525),c=TypeError,l=r("toPrimitive");t.exports=function(t,i){if(!s(t)||o(t))return t;var e,r=a(t,l);if(r){if(void 0===i&&(i="default"),e=n(r,t,i),!s(e)||o(e))return e;throw new c("Can't convert object to primitive value")}return void 0===i&&(i="number"),h(t,i)}},5612:function(t,i,e){var n=e(9022),s=e(9934);t.exports=function(t){var i=n(t,"string");return s(i)?i:i+""}},8049:function(t,i,e){var n={};n[e(4525)("toStringTag")]="z",t.exports="[object z]"===String(n)},6516:function(t,i,e){var n=e(3242),s=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return s(t)}},7674:function(t){var i=String;t.exports=function(t){try{return i(t)}catch(t){return"Object"}}},6482:function(t,i,e){var n=e(3930),s=0,o=Math.random(),a=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++s+o,36)}},2806:function(t,i,e){var n=e(3293);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},9850:function(t,i,e){var n=e(7233),s=e(6261);t.exports=n&&s((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},6084:function(t,i,e){var n=e(8386),s=e(1051),o=n.WeakMap;t.exports=s(o)&&/native code/.test(String(o))},4525:function(t,i,e){var n=e(8386),s=e(8688),o=e(4592),a=e(6482),h=e(3293),r=e(2806),c=n.Symbol,l=s("wks"),d=r?c.for||c:c&&c.withoutSetter||a;t.exports=function(t){return o(l,t)||(l[t]=h&&o(c,t)?c[t]:d("Symbol."+t)),l[t]}},8196:function(t,i,e){var n=e(2235),s=e(5278),o=e(4782),a=e(2657),h=e(7567).f,r=e(2482),c=e(3988),l=e(1876),d=e(7233),u="Array Iterator",p=a.set,f=a.getterFor(u);t.exports=r(Array,"Array",(function(t,i){p(this,{type:u,target:n(t),index:0,kind:i})}),(function(){var t=f(this),i=t.target,e=t.index++;if(!i||e>=i.length)return t.target=void 0,c(void 0,!0);switch(t.kind){case"keys":return c(e,!1);case"values":return c(i[e],!1)}return c([e,i[e]],!1)}),"values");var m=o.Arguments=o.Array;if(s("keys"),s("values"),s("entries"),!l&&d&&"values"!==m.name)try{h(m,"name",{value:"values"})}catch(t){}},1011:function(t,i,e){var n=e(6589),s=e(5317);n({target:"RegExp",proto:!0,forced:/./.exec!==s},{exec:s})},8023:function(t,i,e){var n=e(7987),s=e(8789),o=e(3930),a=e(4562),h=e(6261),r=e(7033),c=e(1051),l=e(5582),d=e(5342),u=e(6177),p=e(6516),f=e(1628),m=e(8808),g=e(8285),v=e(9267),C=e(9786),x=e(4525)("replace"),b=Math.max,y=Math.min,w=o([].concat),S=o([].push),P=o("".indexOf),L=o("".slice),T="$0"==="a".replace(/./,"$0"),M=!!/./[x]&&""===/./[x]("a","$0");a("replace",(function(t,i,e){var o=M?"$":"$0";return[function(t,e){var n=f(this),o=l(t)?void 0:g(t,x);return o?s(o,t,n,e):s(i,p(n),t,e)},function(t,s){var a=r(this),h=p(t);if("string"==typeof s&&-1===P(s,o)&&-1===P(s,"$<")){var l=e(i,a,h,s);if(l.done)return l.value}var f=c(s);f||(s=p(s));var g,x=a.global;x&&(g=a.unicode,a.lastIndex=0);for(var T,M=[];null!==(T=C(a,h))&&(S(M,T),x);){""===p(T[0])&&(a.lastIndex=m(h,u(a.lastIndex),g))}for(var k,J="",E=0,I=0;I<M.length;I++){for(var A,D=p((T=M[I])[0]),R=b(y(d(T.index),h.length),0),O=[],F=1;F<T.length;F++)S(O,void 0===(k=T[F])?k:String(k));var _=T.groups;if(f){var W=w([D],O,R,h);void 0!==_&&S(W,_),A=p(n(s,void 0,W))}else A=v(D,h,R,O,_,s);R>=E&&(J+=L(h,E,R)+A,E=R+D.length)}return J+L(h,E)}]}),!!h((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!T||M)},5817:function(t,i,e){var n=e(8386),s=e(884),o=e(4739),a=e(8196),h=e(7917),r=e(4807),c=e(4525)("iterator"),l=a.values,d=function(t,i){if(t){if(t[c]!==l)try{h(t,c,l)}catch(i){t[c]=l}if(r(t,i,!0),s[i])for(var e in a)if(t[e]!==a[e])try{h(t,e,a[e])}catch(i){t[e]=a[e]}}};for(var u in s)d(n[u]&&n[u].prototype,u);d(o,"DOMTokenList")}},i={};function e(n){var s=i[n];if(void 0!==s)return s.exports;var o=i[n]={exports:{}};return t[n].call(o.exports,o,o.exports,e),o.exports}e.d=function(t,i){for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};!function(){e.r(n),e.d(n,{default:function(){return A}});class t{constructor(){let{width:t,height:i,pixelRadio:e,canvasId:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.width=t||375,this.height=i||500,this.canvasId=n,this.pixelRadio=e||2,this.charts=[],this.currentChartIndex=0}initCanvas(){const t=document.getElementById(this.canvasId);this.ctx=t.getContext("2d");const i=this.pixelRadio;this.canvasWidth=this.width*i,this.canvasHeight=this.height*i}getCtx(){!this.ctx&&this.initCanvas();return this.ctx}redraw(){this.initCanvas();const t=this.getCurrentChart();t&&t.redraw()}getCurrentChart(){return this.charts[this.currentChartIndex]}show(t){if(t){const i=this.charts.indexOf(t);i>=0?(this.currentChartIndex=i,t.initSubscribe()):(this.currentChartIndex=this.charts.length,this.addChart(t))}this.redraw()}addChart(t){this.charts.push(t),t.setCanvas(this)}clear(){this.ctx&&this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.save()}drawCanvas(){this.ctx&&this.ctx.restore()}touchstart(t){this.lastX=t.changedTouches[0].clientX*this.pixelRadio}touchmove(t,i){const e=this.getCurrentChart(),n=t.touches[0],s=n.pageX*this.pixelRadio,o=n.pageY*this.pixelRadio;i*=this.pixelRadio;e&&e.panMove(this.pressed,s,o,i)&&(this.lastX=s)}touchend(){this.pressed=!1,this.lastX=0;const t=this.getCurrentChart();t&&t.panMove(this.pressed)}longtap(t){this.pressed=!0;const i=this.getCurrentChart(),e=t.touches[0];let n=0,s=0;e.offsetX&&e.offsetY?(n=e.offsetX*this.pixelRadio,s=e.offsetY*this.pixelRadio):(n=(e.pageX-t.target.offsetLeft)*this.pixelRadio,s=(e.pageY-t.target.offsetTop)*this.pixelRadio),i&&i.panMove(this.pressed,n,s)}pinch(t,i){if(!this.pressed){let t=this.getCurrentChart();t&&t.pinchMove(i)}}toggleMask(t){}drawLine(t,i,e,n,s,o){const a=this.ctx;a.beginPath(),a.lineWidth=s,a.strokeStyle=o,a.moveTo(this.normalizeDrawLinePoint(t),this.normalizeDrawLinePoint(i)),a.lineTo(this.normalizeDrawLinePoint(e),this.normalizeDrawLinePoint(n)),a.stroke()}createHorzDashedLine(t,i,e,n,s){const o=this.ctx;o.beginPath(),o.lineWidth=n,o.strokeStyle=s;let a=(i-t)/8+.5<<0;for(let i=0;i<a;i++)o.moveTo(this.normalizeDrawLinePoint(t),this.normalizeDrawLinePoint(e)),o.lineTo(this.normalizeDrawLinePoint(t+4),this.normalizeDrawLinePoint(e)),t+=8;o.stroke()}createVerticalDashedLine(t,i,e,n,s){const o=this.ctx;o.beginPath(),o.lineWidth=n,o.strokeStyle=s;let a=(e-i)/8+.5<<0;for(let e=0;e<a;e++)o.moveTo(this.normalizeDrawLinePoint(t),this.normalizeDrawLinePoint(i)),o.lineTo(this.normalizeDrawLinePoint(t),this.normalizeDrawLinePoint(i+4)),i+=8;o.stroke()}drawText(t,i,e,n,s,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const h=this.ctx;h.font="".concat(n,"px ").concat(s);const r=this.measureText(t,n),c=Math.min(Math.max(i,0),this.canvasWidth-r),l=e;a&&(h.fillStyle=a,h.rect(c-2,l+2,r+4,-(n+4)),h.fill()),h.beginPath(),h.fillStyle=o,h.fillText(t,c,l)}fillPath(t,i,e,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const o=this.ctx;o.beginPath(),t.forEach(((t,i)=>{0===i?o.moveTo(t[0],t[1]):o.lineTo(t[0],t[1])})),o.lineWidth=s,o.strokeStyle=e,o.lineJoin="round",o.stroke(),t.length>1?(o.lineWidth=0,o.lineTo(t[t.length-1][0],i),o.lineTo(t[0][0],i),o.closePath(),o.fillStyle=n,o.fill()):o.closePath()}drawPath(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=this.ctx;n.beginPath(),n.lineJoin="round",n.lineWidth=e,n.strokeStyle=i,t.forEach(((t,i)=>{0===i?n.moveTo(t[0],t[1]):n.lineTo(t[0],t[1])})),n.stroke(),n.closePath()}drawRect(t,i,e,n,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6?arguments[6]:void 0;const h=this.ctx;t&&i&&e&&n&&(h.beginPath(),h.rect(t,i,e,n),h.closePath(),h.fillStyle=s,h.fill(),o&&a&&(h.lineWidth=o,h.strokeStyle=a,h.stroke()))}drawCircle(t,i,e,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;const a=this.ctx;a.beginPath(),a.arc(t,i,e,0,2*Math.PI),a.closePath(),a.fillStyle=n,a.fill(),s&&o&&(a.lineWidth=s,a.strokeStyle=o,a.stroke())}normalizeDrawLinePoint(t){if(1===this.pixelRadio){const i=parseInt(t,10);return i>t?i-.5:i+.5}return t}measureText(t,i,e){const n=this.ctx;return n.font="".concat(i,"px ").concat(e),n.measureText(t).width}}e(5817),e(8023);const i=function(t,i,e,n,s,o){let a=Number(t);if((null==t||isNaN(a)||a===1/0||a===-1/0)&&!1!==n)return"string"==typeof n?n:"--";const h=Math.abs(a),r=a;return i=null!=i?i:2,(e=e||"")&&(e.indexOf("B")>=0&&h>=1e9?(e="B",a/=1e9):e.indexOf("万亿")>=0&&h>=1e12?(e="万亿",a/=1e12):e.indexOf("亿")>=0&&h>=1e8?(e="亿",a/=1e8):e.indexOf("M")>=0&&h>=1e6?(e="M",a/=1e6):e.indexOf("万")>=0&&h>=1e4?(e="万",a/=1e4):e.indexOf("K")>=0&&h>=1e3?(e="K",a/=1e3):100===e?(e="",a/=100):"%"===e?a*=100:e=""),a===r&&!0===s&&(i=0),o&&(a=Math.abs(a)),(a+1e-8).toFixed(i)+e};var s={formatStockCode:function(t){return t.substring(2)},formatStockText:i,formatPrice:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&t>=0?"+"+i(t,e):i(t,e)},formatVolume:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e||(e=1),null!=t&&(t/=e),i(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,"万亿",!0,!0)},formatRatio:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;return n||(n=1),null!=t&&(t/=n),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&t>0?"+"+i(t,e,"%"):i(t,e,"%")},formatColor:function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["","stock-up","stock-down"];return!e||e.length<=2?"":null==t||isNaN(t)?e[0]:t>i?e[1]:t<i?e[2]:e[0]},getStockType:function(t){let i="";switch(t){case 0:i="指数";break;case 1:i="股票";break;case 2:i="基金";break;case 3:i="债券";break;case 4:i="其它股票";break;case 5:i="选择权";break;case 6:i="外汇";break;case 7:i="期货";break;case 8:i="期指";break;case 9:i="认购证";break;case 10:i="ETF";break;case 11:i="LOF";break;case 12:i="可转债";break;case 13:i="信托";break;case 14:i="权证";break;case 15:i="回购";break;case 16:i="商品现货";break;case 17:i="股票基金";break;case 18:i="债券基金";break;case 19:i="混合型基金";break;case 20:i="保本型基金";break;case 21:i="货币一般基金";break;case 22:i="货币净值基金";break;case 23:i="短期理财基金";break;case 24:i="QDII基金";break;case 25:i="拆借";break;case 26:i="利率";break;case 27:i="分级A基金";break;case 28:i="分级B基金";break;case 29:i="分级母基金"}return i},formatDate:function(t,i){const e=new Date(t),n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};let s;return/(y+)/.test(i)&&(i=i.replace(RegExp.$1,"".concat(e.getFullYear()).substr(4-RegExp.$1.length))),Object.keys(n).forEach((t=>{s=n[t],new RegExp("(".concat(t,")")).test(i)&&(i=i.replace(RegExp.$1,1===RegExp.$1.length?s:"00".concat(s).substr(JSON.stringify(s).length)))})),i},debounce:function(t,i,e){let n;return function(){let s=this,o=arguments,a=e&&!n;window.clearTimeout(n),n=window.setTimeout((function(){n=null,e||t.apply(s,o)}),i),a&&t.apply(s,o)}},throttle:function(t,i,e){let n,s=new Date;return function(){let o=this,a=arguments,h=new Date;window.clearTimeout(n),h-s>=e?(t.apply(o,a),s=h):n=window.setTimeout(t,i)}}};const o=function(){};class a{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dataProvider=t,this.options=i,this.longTap=i.longTap||o,this.labelMargin=2}initData(){if(this.simplifiedMode=this.options.simplifiedMode||!1,this.currentIndics=this.options.currentIndics||"VOL",this.fontSize=(this.options.fontSize||12)*this.canvas.pixelRadio,this.fontFamily=this.options.fontFamily||"Arial",this.upColor=this.options.upColor||"#ff0000",this.downColor=this.options.downColor||"#008000",this.gridLineColor=this.options.gridLineColor||"#dddddd",this.tickColor=this.options.tickColor||"#555555",this.pricePrecision=this.options.pricePrecision||2,this.volPrecision=this.options.volPrecision||0,this.pointerLineColor=this.options.pointerLineColor||"#999999",this.pointerTickColor=this.options.pointerTickColor||"#ffffff",this.tickBackgroundColor=this.options.tickBackgroundColor||"#eeeeee",this.minLineColor=this.options.minLineColor||"#0095D9",this.simplifiedMode){let t=this.canvas.getCtx();if("object"==typeof this.minFillColor){let i=this.minFillColor;if(i.type&&"LinearGradient"===i.type){let e=t.createLinearGradient(...i.layout);i.colors.length>0&&i.colors.forEach((t=>{e.addColorStop(t[0],t[1])}))}}this.minFillColor=gradient}else this.minFillColor=this.options.minFillColor||"rgba(0, 149, 217, 0.2)";this.timeAxisHeight=this.fontSize+8,this.gridLineWidth=1,this.horizLineCount=this.options.horizLineCount||4,this.leftRangeWidth=this.options.leftRangeWidth*this.canvas.pixelRadio||0,this.rightRangeWidth=this.options.rightRangeWidth*this.canvas.pixelRadio||0,this.chartExtend=this.options.chartExtend}initSubscribe(){}setCanvas(t){this.canvas=t,this.initData()}show(){this.canvas&&this.canvas.show(this)}remove(){this.canvas&&this.canvas.remove(this)}redraw(){this.canvas&&this.canvas.getCurrentChart()===this&&this.canvas.canvasWidth&&this.canvas.canvasHeight&&(this.canvas.clear(),this.initChart(),this.drawBackground(),this.drawChart(),this.drawAxisTicks(),this.drawChartExtend(),this.canvas&&this.canvas.toggleMask(!1),this.canvas.drawCanvas())}initChart(){this.yAxisTicks=[];const t=this.timeAxisHeight,i=(this.currentIndics,this.canvas.canvasHeight-t);"NONE"!==this.currentIndics?(this.mainChartHeight=.7*i,this.volumeChartHeight=.3*i,this.indicsChartHeight=.3*i):(this.mainChartHeight=i,this.volumeChartHeight=0,this.indicsChartHeight=0),this.mainChartWidth=this.canvas.canvasWidth-this.leftRangeWidth-this.rightRangeWidth}drawBackground(){this.simplifiedMode||(this.drawYAxisGridLine(0),this.drawYAxisGridLine(this.canvas.canvasHeight-1),this.drawXAxisGridLine(this.leftRangeWidth,void 0,void 0,void 0,void 0,!0),this.drawXAxisGridLine(this.canvas.canvasWidth-this.rightRangeWidth-1,void 0,void 0,void 0,void 0,!0))}getPoint(t,i){return null}getLowPricePoint(t){return null}drawChartExtend(t){if(!this.chartExtend)return;if(this.chartExtend instanceof Array&&0===this.chartExtend.length)return;this.leftRangeWidth;let i=this.canvas.canvasWidth-this.rightRangeWidth,e=this.mainChartHeight;this.chartExtend.forEach(((n,s)=>{if("label"===n.type){let s=n.data;if(s&&s instanceof Array){let o=n.style||{},a=o.line||"#FF8245",h=o.text||"#FF8245",r=o.background||"#FFEFE7";for(let n=0;n<s.length;n++){let o=s[n],c=this.getPoint(o.time,o.price);if(c){let n=c.x+12,s=c.y+12,l=n,d=s,u=this.canvas.measureText(o.text,this.fontSize,this.fontFamily)+6,p=this.fontSize+8;n+u>i&&(n=c.x-12,l=n-u),s+p>e&&(s=c.y-12,d=s-p),this.canvas.drawCircle(c.x,c.y,2,a,1,a),this.canvas.drawPath([[c.x,c.y],[n,s]],a,1),this.canvas.drawRect(l,d,u,p,r,2,a),this.canvas.drawText(o.text,l+3,d+this.fontSize+3,this.fontSize,this.fontFamily,h),t&&this.canvas.drawText(o.price,l+1,d-3,this.fontSize,this.fontFamily,h)}}}}else if("tag"===n.type){let t=n.data;if(t&&t instanceof Array){let i=n.style||{},e=i.line||"#FF8245",s=i.text||"#FF8245",o=i.background||"#FFEFE7";for(let i=0;i<t.length;i++){let n=t[i],a=this.getLowPricePoint(n.time);if(a){let t=this.canvas.measureText(n.text,this.fontSize,this.fontFamily)+6,i=this.fontSize+8,h=a.x-t/2,r=a.y+2;this.canvas.drawRect(h,r,t,i,o,2,e),this.canvas.drawText(n.text,h+3,r+this.fontSize+3,this.fontSize,this.fontFamily,s)}}}}}))}drawChart(){}getLastIndicatorData(){return null}drawAxisTicks(){const t=this.yAxisTicks;if(t){const i=this.canvas,e=this.tickBackgroundColor;t.forEach((t=>{i.drawText(t.text,t.x,t.y,this.fontSize,this.fontFamily,t.tickColor,t.withBackground&&e)}))}}formatYAxisLabel(t,i){return s.formatStockText(t,i,"",!1)}formatXAxisLabel(t){return t}getColor(t){return t?this.upColor:this.downColor}drawYAxisGridLine(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gridLineColor,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.tickColor,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"solid";if("solid"===h?this.canvas.drawLine(this.leftRangeWidth,t,this.canvas.canvasWidth-this.rightRangeWidth,t,this.gridLineWidth,e):"dashed"===h&&this.canvas.createHorzDashedLine(this.leftRangeWidth,this.canvas.canvasWidth-this.rightRangeWidth,t,this.gridLineWidth,e),i){const e=this.yAxisTicks;let h=this.labelMargin,r=this.formatYAxisLabel(i,a);if(this.leftRangeWidth>0){let t=this.canvas.measureText(r,this.fontSize,this.fontFamily);t<this.leftRangeWidth&&(h=this.leftRangeWidth-t-this.labelMargin)}h<0&&(h=0);let c=t;switch(n){case"top":c=t-2;break;case"bottom":c=t+this.fontSize+2;break;case"center":c=t+this.fontSize/2-1;break;default:c=t}e.push({text:r,x:h,y:c,tickColor:o,withBackground:s})}}drawXAxisGridLine(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gridLineColor,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.tickColor,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"solid";if(!(arguments.length>7&&void 0!==arguments[7])||arguments[7]){let i=o?this.canvas.canvasHeight:this.mainChartHeight;"solid"===h?this.canvas.drawLine(t,0,t,i,this.gridLineWidth,e):"dashed"===h&&this.canvas.createVerticalDashedLine(t,0,i,this.gridLineWidth,e)}if(i){const e=this.canvas.measureText(i,this.fontSize,this.fontFamily),o=this.fontSize;let h=t;switch(n){case"middle":h=t-e/2;break;case"left":default:h=t;break;case"right":h=t-e}const r=this.mainChartHeight+o+2;this.canvas.drawText(i,h,r,o,this.fontFamily,a,s&&this.tickBackgroundColor)}}panMove(t,i,e,n){}pinchMove(t){}}class h extends a{initData(){super.initData(),this.customInterval=this.options.customInterval||60,this.avgPriceColor=this.options.avgPriceColor||"#EB5F15",this.cache=null,this.canvas&&this.canvas.toggleMask(!0),this.initSubscribe()}initSubscribe(){this.dataProvider.subscribeMin((t=>{this.cache=t,this.redraw()}))}initChart(){super.initChart(),this.hasAvgPrice=!1!==this.options.hasAvgPrice;const t=this.cache.lastClose,i=Number.MAX_VALUE,e=Number.MIN_VALUE;let n=i,s=0,o=0;if(t){let i,e=0;Object.keys(this.cache).forEach((n=>{i=this.cache[n],i&&i.ChengJiaoJia&&(e=Math.max(e,Math.abs(i.ChengJiaoJia-t)),o=Math.max(o,i.ChengJiaoLiang))})),s=t+e,n=t-e}else{let t;Object.keys(this.cache).forEach((a=>{t=this.cache[a],t&&t.ChengJiaoJia&&(s=Math.max(s,t.ChengJiaoJia||e),n=Math.min(n,t.ChengJiaoJia||i),o=Math.max(o,t.ChengJiaoLiang))}))}this.max=s>n?s:1.1*s,this.min=s>n?n:.9*s,this.min<0&&(this.min=0),this.maxVolume=o,this.minChartHeight=this.mainChartHeight,this.minYPixelRadio=this.minChartHeight/(this.max-this.min),this.volumeYPixelRadio=this.indicsChartHeight/o,this.pixelPer=this.mainChartWidth/this.cache.minTimes.length}formatXAxisLabel(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=new Date(t);return i?s.formatDate(e,"yyyy-MM-dd hh:mm"):s.formatDate(e,"hh:mm")}redraw(){this.cache&&super.redraw()}drawChart(){const t="VOL"===this.currentIndics,i=this.cache.minTimes,e=this.cache.timeIntervalPoints,n=this.pixelPer,s=[],o=[],a=this.hasAvgPrice;let h=this.cache.lastClose;const r=i.length>300?60:30;let c,l=-1e3,d=[];i.forEach(((c,u)=>{const p=this.cache[c];if(p){const i=p.isUp=p.ChengJiaoJia>=h,e=n*u+this.leftRangeWidth+n/2;p.ChengJiaoJia&&s.push([e,(this.max-p.ChengJiaoJia)*this.minYPixelRadio]),a&&p.JunJia&&o.push([e,(this.max-p.JunJia)*this.minYPixelRadio,!(p.JunJia>this.max||p.JunJia<this.min)]),t&&this.drawVolume(u,p.ChengJiaoLiang,i),h=p.ChengJiaoJia}if(0===u||u===i.length-1)l=u,d.push({index:u,text:this.formatXAxisLabel(i[u]),position:0===u?"left":"right",x:n*u+n/2+this.leftRangeWidth,lineType:void 0,showLine:!1,mustShow:!0});else if(e.indexOf(c)>-1)l=u,d.push({index:u,text:this.formatXAxisLabel(i[u]),position:"middle",x:n*u+n/2+this.leftRangeWidth,lineType:"solid",showLine:!0,mustShow:!1});else{let t;c-i[u-1]>6e4&&l!==u-1?t=u-1:new Date(c).getMinutes()%r==0&&(t=u),t&&(t-l)*n>55*this.canvas.pixelRadio&&t-l>=this.customInterval&&(d.push({index:t,text:this.formatXAxisLabel(i[t]),position:"middle",x:n*t+n/2+this.leftRangeWidth,lineType:"dashed",showLine:!0,mustShow:!1}),l=t)}}));for(let t=0,i=d.length;t<i;t++){if(c=d[t],!c.mustShow){let i=d[t-1],e=d[t+1];if(i&&e){if(c.x-i.x<55*this.canvas.pixelRadio)continue;if(e.x-c.x<55*this.canvas.pixelRadio)continue}}this.simplifiedMode||this.drawXAxisGridLine(c.x,c.text,void 0,c.position,!1,!1,void 0,c.showLine,c.lineType)}if(this.canvas.fillPath(s,this.minChartHeight,this.minLineColor,this.minFillColor,this.simplifiedMode?2:1),a&&this.canvas.drawPath(o,this.avgPriceColor),this.pressPoint){let{x:t,y:e}=this.pressPoint;if(t<=this.leftRangeWidth||t>=this.canvas.canvasWidth-this.rightRangeWidth)return;t-=this.leftRangeWidth;const s=Number.parseInt(t/n,10),o=i[s],a=this.cache[o];if(a){t=n*s+n/2+this.leftRangeWidth,this.drawXAxisGridLine(t,this.formatXAxisLabel(o),this.pointerLineColor,void 0,!0,!0,this.pointerTickColor);const i=a.ChengJiaoJia;e=(this.max-i)*this.minYPixelRadio,this.drawYAxisGridLine(e,i,this.pointerLineColor,e>this.minChartHeight/2?"top":"bottom",!0,this.pointerTickColor),this.canvas.drawCircle(t,e,3,"rgba(230, 100, 100, 0.8)");let h=Object.assign({},{lastClose:this.cache.lastClose},a);this.longTap(h,"min")}}}drawVolume(t,i,e){const n=this.pixelPer*t+this.leftRangeWidth,s=this.canvas.canvasHeight,o=Math.max(.5,this.pixelPer-1),a=-this.volumeYPixelRadio*i;this.canvas.drawRect(n,s,o,a,this.getColor(e))}drawTooltip(t){var i=this;const e=this.fontSize,n=e+2,o=this.cache.lastClose;let a=50+this.leftRangeWidth;const h=this.formatXAxisLabel(1e3*t.ShiJian),r=s.formatStockText(t.ChengJiaoJia,2),c=s.formatStockText((t.ChengJiaoJia-o)/o,2,"%"),l=s.formatStockText(t.ChengJiaoLiang,2,"K/M");[{label:"时间:".concat(h),labelColor:"#555555"},{label:"价格:".concat(r),labelColor:"#0095D9"},this.hasAvgPrice&&t.JunJia<=this.max&&t.JunJia>=this.min?{label:"均价:".concat(s.formatStockText(t.JunJia,2)),labelColor:"#EB5F15"}:void 0,{label:"涨跌:".concat(c),labelColor:this.getColor(t.ChengJiaoJia>=o)},{label:"成交量:".concat(l),labelColor:this.getColor(t.isUp)}].forEach((function(){let{label:t,labelColor:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&(i.canvas.drawText(t,a,n,e,i.fontFamily,s),a+=i.canvas.measureText(t,e,i.fontFamily)+10)}))}drawBackground(){super.drawBackground();const t=this.cache.lastClose,i=this.max,e=this.min;this.simplifiedMode||(this.drawYAxisGridLine(0,i,void 0,"bottom",void 0,this.getColor(!0),this.pricePrecision),this.drawYAxisGridLine(this.minChartHeight,e,void 0,void 0,void 0,this.getColor(!1),this.pricePrecision)),this.drawYAxisGridLine(this.minChartHeight/2,this.simplifiedMode?"":t||i-(i-e)/2,void 0,"center",void 0,void 0,this.pricePrecision);for(let t=1;t<this.horizLineCount;t++)t!==this.horizLineCount/2&&this.drawYAxisGridLine(this.minChartHeight*(t/this.horizLineCount),i-(i-e)*(t/this.horizLineCount),void 0,"center",void 0,this.getColor(t<this.horizLineCount/2),this.pricePrecision,"dashed");"VOL"===this.currentIndics&&(super.drawYAxisGridLine(this.canvas.canvasHeight,"0",void 0,void 0,void 0,void 0,this.volPrecision),super.drawYAxisGridLine(this.canvas.canvasHeight-this.volumeChartHeight/2,this.maxVolume/2,void 0,void 0,void 0,void 0,this.volPrecision,"dashed"),super.drawYAxisGridLine(this.canvas.canvasHeight-this.volumeChartHeight,this.maxVolume,void 0,"bottom",void 0,void 0,this.volPrecision))}getPoint(t,i){if(i>this.max||i<this.min)return null;let e=this.cache.minTimes.indexOf(t);return-1===e?null:{x:this.pixelPer*e+this.pixelPer/2+this.leftRangeWidth,y:(this.max-i)*this.minYPixelRadio}}drawChartExtend(){super.drawChartExtend(!0)}drawYAxisGridLine(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gridLineColor,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.tickColor,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"solid";if(super.drawYAxisGridLine(t,i,e,n,o,a,h,r),i){const e=this.yAxisTicks,h=s.formatStockText((i-this.cache.lastClose)/this.cache.lastClose,2,"%",!1);let r;r=this.rightRangeWidth>0?this.canvas.canvasWidth-this.rightRangeWidth+this.labelMargin:this.canvas.canvasWidth-this.canvas.measureText(h,this.fontSize,this.fontFamily)-this.labelMargin;let c=t;switch(n){case"top":c=t-2;break;case"bottom":c=t+this.fontSize+2;break;case"center":c=t+this.fontSize/2-1;break;default:c=t}e.push({text:h,x:r,y:c,tickColor:a,withBackground:o})}}panMove(t,i,e){this.pressPoint=t?{x:i,y:e}:null,this.redraw()}}class r extends a{initData(){super.initData(),this.customInterval=this.options.customInterval||60,this.avgPriceColor=this.options.avgPriceColor||"#EB5F15",this.days=this.options.days||5,this.cache=null,this.canvas&&this.canvas.toggleMask(!0),this.initSubscribe()}initSubscribe(){this.dataProvider.subMultiMin((t=>{this.cache=t,this.redraw()}),{days:this.days})}initChart(){super.initChart(),this.hasAvgPrice=!1!==this.options.hasAvgPrice;const t=this.cache.lastClose,i=Number.MAX_VALUE,e=Number.MIN_VALUE;let n=i,s=0,o=0;if(t){let i,e=0;Object.keys(this.cache).forEach((n=>{i=this.cache[n],i&&i.ChengJiaoJia&&(e=Math.max(e,Math.abs(i.ChengJiaoJia-t)),o=Math.max(o,i.ChengJiaoLiang))})),s=t+e,n=t-e}else{let t;Object.keys(this.cache).forEach((a=>{t=this.cache[a],t&&t.ChengJiaoJia&&(s=Math.max(s,t.ChengJiaoJia||e),n=Math.min(n,t.ChengJiaoJia||i),o=Math.max(o,t.ChengJiaoLiang))}))}this.max=s>n?s+.1*(s-n):1.1*s,this.min=s>n?n-.1*(s-n):.9*s,this.min<0&&(this.min=0),this.maxVolume=o,this.minChartHeight=this.mainChartHeight,this.minYPixelRadio=this.minChartHeight/(this.max-this.min),this.volumeYPixelRadio=this.indicsChartHeight/o,this.pixelPer=this.mainChartWidth/this.cache.minTimes.length}formatXAxisLabel(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=new Date(t);return i?s.formatDate(e,"yyyy-MM-dd hh:mm"):s.formatDate(e,"MM-dd")}redraw(){this.cache&&super.redraw()}drawChart(){const t="VOL"===this.currentIndics,i=this.cache.minTimes,e=this.pixelPer,n=[],s=[],o=this.hasAvgPrice;let a=this.cache.lastClose;i.length;let h,r,c=-1;if(i.forEach(((l,d)=>{const u=this.cache[l];if(u){const i=u.isUp=u.ChengJiaoJia>=a,h=e*d+this.leftRangeWidth+e/2;u.ChengJiaoJia&&n.push([h,(this.max-u.ChengJiaoJia)*this.minYPixelRadio]),o&&u.JunJia&&s.push([h,(this.max-u.JunJia)*this.minYPixelRadio,!(u.JunJia>this.max||u.JunJia<this.min)]),t&&this.drawVolume(d,u.ChengJiaoLiang,i),a=u.ChengJiaoJia}if(r=this.formatXAxisLabel(l),r!==h&&(h=r,-1===c&&d>0||(d-c)*e>55*this.canvas.pixelRadio)){c=d;let t=0!==d&&d!==i.length-1;this.drawXAxisGridLine(e*d+e/2+this.leftRangeWidth,r,void 0,void 0,void 0,void 0,void 0,t,"dashed")}})),this.canvas.fillPath(n,this.minChartHeight,this.minLineColor,this.minFillColor),o&&this.canvas.drawPath(s,this.avgPriceColor),this.pressPoint){let{x:t,y:n}=this.pressPoint;if(t<=this.leftRangeWidth||t>=this.canvas.canvasWidth-this.rightRangeWidth)return;t-=this.leftRangeWidth;const s=Number.parseInt(t/e,10),o=i[s],a=this.cache[o];if(a){t=e*s+e/2+this.leftRangeWidth,this.drawXAxisGridLine(t,this.formatXAxisLabel(o,!0),this.pointerLineColor,void 0,!0,!0,this.pointerTickColor);const i=a.ChengJiaoJia;n=(this.max-i)*this.minYPixelRadio,this.drawYAxisGridLine(n,i,this.pointerLineColor,n>this.minChartHeight/2?"top":"bottom",!0,this.pointerTickColor),this.canvas.drawCircle(t,n,3,"rgba(230, 100, 100, 0.8)");let h=Object.assign({},{lastClose:this.cache.lastClose},a);this.longTap(h,"multi-min")}}}drawVolume(t,i,e){const n=this.pixelPer*t+this.leftRangeWidth,s=this.canvas.canvasHeight,o=Math.max(.5,this.pixelPer-1),a=-this.volumeYPixelRadio*i;this.canvas.drawRect(n,s,o,a,this.getColor(e))}drawBackground(){super.drawBackground();const t=this.cache.lastClose,i=this.max,e=this.min;this.drawYAxisGridLine(0,i,void 0,"bottom",void 0,this.getColor(!0),this.pricePrecision),this.drawYAxisGridLine(this.minChartHeight,e,void 0,void 0,void 0,this.getColor(!1),this.pricePrecision),this.drawYAxisGridLine(this.minChartHeight/2,t||i-(i-e)/2,void 0,"center",void 0,void 0,this.pricePrecision,"dashed");for(let t=1;t<this.horizLineCount;t++)t!==this.horizLineCount/2&&this.drawYAxisGridLine(this.minChartHeight*(t/this.horizLineCount),i-(i-e)*(t/this.horizLineCount),void 0,"center",void 0,this.getColor(t<this.horizLineCount/2),this.pricePrecision,"dashed");super.drawYAxisGridLine(this.canvas.canvasHeight,"0",void 0,void 0,void 0,void 0,this.volPrecision),super.drawYAxisGridLine(this.canvas.canvasHeight-this.volumeChartHeight,this.maxVolume,void 0,"bottom",void 0,void 0,this.volPrecision)}drawChartExtend(){}drawYAxisGridLine(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gridLineColor,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.tickColor,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"solid";if(super.drawYAxisGridLine(t,i,e,n,o,a,h,r),i){const e=this.yAxisTicks,h=s.formatStockText((i-this.cache.lastClose)/this.cache.lastClose,2,"%",!1);let r;r=this.rightRangeWidth>0?this.canvas.canvasWidth-this.rightRangeWidth+this.labelMargin:this.canvas.canvasWidth-this.canvas.measureText(h,this.fontSize,this.fontFamily)-this.labelMargin;let c=t;switch(n){case"top":c=t-2;break;case"bottom":c=t+this.fontSize+2;break;case"center":c=t+this.fontSize/2-1;break;default:c=t}e.push({text:h,x:r,y:c,tickColor:a,withBackground:o})}}panMove(t,i,e){this.pressPoint=t?{x:i,y:e}:null,this.redraw()}}class c extends a{initData(){super.initData(),this.mIndics=this.options.mIndics,this.maColor=this.options.maColor||["#FFD11E","#F77BFC","#39C2FD","#B7B7B7","#D3141A","#FF8802"],this.bollColor=this.options.bollColor||["#FFD11E","#F77BFC","#39C2FD"],this.macdColor=this.options.macdColor||["#FFD11E","#F77BFC"],this.kdjColor=this.options.kdjColor||["#FFD11E","#F77BFC","#39C2FD"],this.rsiColor=this.options.rsiColor||["#FFD11E","#F77BFC","#39C2FD"],this.dmaColor=this.options.dmaColor||["#FFD11E","#F77BFC"],this.biasColor=this.options.biasColor||["#FFD11E","#F77BFC","#39C2FD"],this.cciColor=this.options.cciColor||["#FFD11E"],this.w8rColor=this.options.w8rColor||["#FFD11E","#F77BFC"],this.dbjjColor=this.options.dbjjColor||["#FF0F0F","#EEEEEE","#FF0F0F"],this.qszzColor=this.options.qszzColor||["#E61919","#1CA249","#1CA249","#E61919","#FF0000","#1A75F1"],this.qszzBSTag=this.options.qszzBSTag,this.maCount=this.options.maCount||4,this.data=this.options.data||[],this.klineTimes=[],this.cache=[].concat(this.data),this.indicsData={},this.period=this.options.period||"1day",this.split=void 0!==this.options.split?this.options.split:1,this.maxCount=this.options.maxCount||Number.MAX_VALUE,this.minCount=this.options.minCount||50,this.maxPreLoadCount=this.options.maxPreLoadCount||300,this.position=0,this.hasMoreData=!0,this.defaultRequestCount=0,this.reCalculate(0,this.options.initCount||80),this.initSubscribe()}initSubscribe(){let t={period:this.period,split:this.split,start:-1};this.dataProvider.subscribeKline(t,(i=>{if(i.length>0){const t=i[0];this.cache.length>0&&(this.cache[this.cache.length-1]=t),this.reCalculate()}"NONE"!==this.currentIndics&&"VOL"!==this.currentIndics&&this.getIndicatorData(this.currentIndics,t),"NONE"!==this.mIndics&&this.getIndicatorData(this.mIndics,t)}))}redraw(){this.data&&super.redraw()}initChart(){super.initChart();let t=this.data.length,i=this.mainChartWidth/t,e=Math.max(2*i/3,.5);i<1?(i=1,t=this.mainChartWidth,this.data=this.data.slice(0,t),this.klineTimes=this.data.map((t=>1e3*t.ShiJian)),this.maxCount=t):e>50&&(i=90,e=60),this.pixelPer=e,this.pixelPerWithSeparator=i;const n=Number.MAX_VALUE,s=Number.MIN_VALUE;let o,a,h=n,r=0,c=0,l=0,d=0;switch("NONE"!==this.mIndics&&"DBJJ"!==this.mIndics&&(o=this.indicsData[this.mIndics]),this.data.forEach((t=>{if(r=Math.max(r,t.ZuiGaoJia||s),h=Math.min(h,t.ZuiDiJia||n),o&&o[t.ShiJian]){let i=o[t.ShiJian],e=0,n=i.length;"QSZZ"===this.mIndics&&(e=4,n=2);for(let t=e,s=e+n;t<s;t++)r=Math.max(r,i[t]),h=Math.min(h,i[t])}if("NONE"!==this.currentIndics)if("VOL"===this.currentIndics)c=Math.max(c,t.ChengJiaoLiang);else{let i=this.indicsData[this.currentIndics];if(i&&i[t.ShiJian]){let e=i[t.ShiJian],n=e.length;"DBJJ"===this.currentIndics&&(n=1);for(let t=0,i=n;t<i;t++)l=Math.max(l,e[t]),d=Math.min(d,e[t])}}})),this.max=r>h?r+.1*(r-h):1.1*r,this.min=r>h?h-.1*(r-h):.9*r,0===this.split&&this.min<0&&(this.min=0),this.maxVolume=c,this.maxIndics=l>=0?Math.ceil(110*l)/100:Math.floor(110*l)/100,this.minIndics=d>=0?Math.ceil(110*d)/100:Math.floor(110*d)/100,this.candleChartHeight=this.mainChartHeight,this.candleYPixelRadio=this.candleChartHeight/(this.max-this.min),c>0&&(this.volumeYPixelRadio=this.volumeChartHeight/c),this.currentIndics){case"VOL":this.indicsYPixelRadio=this.indicsChartHeight/c;break;case"MACD":a=Math.max(Math.abs(this.maxIndics),Math.abs(this.minIndics)),this.indicsYPixelRadio=this.indicsChartHeight/(2*a);break;case"KDJ":case"RSI":case"DMA":case"BIAS":case"CCI":case"W&R":case"DBJJ":a=this.maxIndics-this.minIndics,this.indicsYPixelRadio=this.indicsChartHeight/a}}reCalculate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;const e=this.cache.length;let n=0,s=this.data.length,o=this.position;if(t>0)o<t?this.hasMoreData?n=t-o:o=0:o-=t;else if(t<0){const i=e-o-s;o+=i>-t?-t:i}if(i&&(i=Math.max(i,this.minCount)),i<s)o+=Number.parseInt(s-i,10),s=i;else if(i>s){i=Math.min(i,this.maxCount);let t=Number.parseInt(i-s,10);o<t&&this.hasMoreData?n=t-o:(o=Math.max(o-t,0),s=i)}if(n>0){n+=Math.min(s||n,this.maxPreLoadCount);const o=-(n+e);return this.defaultRequestCount=n,void this.loadMoreData(o,n).then((()=>{this.reCalculate(t,i)}))}this.data=this.cache.slice(o,o+s),this.klineTimes=this.data.map((t=>1e3*t.ShiJian)),this.position=o,this.redraw()}loadMoreData(t,i){this.loading=!0,this.canvas&&this.canvas.toggleMask(!0);const e=this.dataProvider;let n={period:this.period,start:t,count:i,split:this.split};const s=this.dataProvider.getKline(n);return"NONE"!==this.currentIndics&&"VOL"!==this.currentIndics&&this.getIndicatorData(this.currentIndics,n),"NONE"!==this.mIndics&&this.getIndicatorData(this.mIndics,n),s.then((t=>{if(t&&e===this.dataProvider){const i=this.cache[0]?this.cache[0].ShiJian:Number.MAX_VALUE;let e;for(let n=t.length;n>0;n-=1)e=t[n-1],e.ShiJian<i?(this.cache.unshift(e),this.position+=1):this.hasMoreData=!1}this.loading=!1,this.redraw()}))}initIndicator(t){let i=this.cache.length||this.defaultRequestCount;if(i>0){let e={period:this.period,start:-i,count:i,split:this.split};this.getIndicatorData(t,e)}}getIndicatorData(t,i){if("NONE"===t)return;let e={};e={name:t};let n=Object.assign({},i,e);this.dataProvider.getIndicatorData(n).then((i=>{if(i.length>0){let e;for(let n=0,s=i.length;n<s;n++)e=i[n],this.indicsData[t]||(this.indicsData[t]={}),"MA"===t&&(e.JieGuo=e.JieGuo.slice(0,this.maCount)),this.indicsData[t][e.ShiJian]=e.JieGuo;this.redraw()}}))}formatXAxisLabel(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=new Date(t);return e?s.formatDate(n,e):i?s.formatDate(n,"yyyy-MM-dd"):s.formatDate(n,"yyyy-MM")}isUp(t,i,e){return t!==i?i>t:i>e}drawChart(){const t=this.pixelPerWithSeparator,i=this.pixelPer/2,e=this.candleYPixelRadio,n=this.max,s=this.canvas;let o,a,h=-1,r=this.period.indexOf("min")>-1,c="yyyy-MM-dd",l="yyyy-MM";r&&(c="MM-dd hh:mm",l="MM-dd hh");let d=[],u=[],p=[],f=[];const m=this.canvas.canvasHeight-this.indicsChartHeight;let g=-1,v=.15;r&&(v=.4),this.data.forEach(((s,c)=>{let C=s.lastClose;if(C||(C=s.lastClose=c>0?this.data[c-1].ShouPanJia:0,s.time=1e3*s.ShiJian,s.isUp=this.isUp(s.KaiPanJia,s.ShouPanJia,C),s.xAxisLabel=this.formatXAxisLabel(s.time,void 0,l)),a=s.xAxisLabel,a!==o){o=a,-1===h&&c>0&&(this.drawXAxisGridLine(t*c+i+this.leftRangeWidth,this.formatXAxisLabel(s.time,void 0,r?"hh:mm":"yyyy-MM"),void 0,void 0,void 0,void 0,void 0,!1),h=c,g=c);const e=this.canvas.measureText(this.formatXAxisLabel(s.time,void 0,r?"hh:mm":"yyyy-MM"));h===g&&(c-h)*t>=e*(1.5+v)&&c*t<this.mainChartWidth&&(this.drawXAxisGridLine(t*c+i+this.leftRangeWidth,this.formatXAxisLabel(s.time,void 0,r?"hh:mm":"yyyy-MM"),void 0,void 0,void 0,void 0,void 0,!1),h=c),h!==g&&(c-h)*t>=e*(1+v)&&c*t<this.mainChartWidth-.5*e&&(this.drawXAxisGridLine(t*c+i+this.leftRangeWidth,this.formatXAxisLabel(s.time,void 0,r?"hh:mm":"yyyy-MM"),void 0,void 0,void 0,void 0,void 0,!1),h=c)}this.drawCandle(c,s.KaiPanJia,s.ShouPanJia,s.ZuiGaoJia,s.ZuiDiJia,s.isUp);let x,b=t*c+i+this.leftRangeWidth;switch(0===c?b-=i:c===this.data.length-1&&(b+=i),this.currentIndics){case"VOL":this.drawVolume(c,s.ChengJiaoLiang,s.isUp);break;case"MACD":let t=this.indicsData[this.currentIndics];if(t&&t[s.ShiJian]){const i=Math.max(Math.abs(this.maxIndics),Math.abs(this.minIndics));this.calMACDPoints(t[s.ShiJian],p,b,m,i),this.drawMACDStick(c,t[s.ShiJian][2],m)}break;case"KDJ":case"RSI":case"DMA":case"BIAS":case"CCI":case"W&R":x=this.indicsData[this.currentIndics],x&&x[s.ShiJian]&&this.calCommonLinePoints(x[s.ShiJian],f,b,this.maxIndics,this.indicsYPixelRadio,m);break;case"DBJJ":x=this.indicsData[this.currentIndics],x&&x[s.ShiJian]&&this.calCommonLinePoints([x[s.ShiJian][0]],f,b,this.maxIndics,this.indicsYPixelRadio,m)}switch(this.mIndics){case"MA":if(x=this.indicsData[this.mIndics],x&&x[s.ShiJian]){let t=x[s.ShiJian].slice(0,this.maCount);this.calCommonLinePoints(t,d,b,n,e,0)}break;case"BOLL":x=this.indicsData[this.mIndics],x&&x[s.ShiJian]&&this.calCommonLinePoints(x[s.ShiJian],d,b,n,e,0);break;case"DBJJ":if(x=this.indicsData[this.mIndics],x&&x[s.ShiJian]&&1===x[s.ShiJian][1]){let t=this.pixelPerWithSeparator*c+this.pixelPerWithSeparator/2-this.pixelPer/2+this.leftRangeWidth+this.pixelPer/2,i=(n-s.ZuiDiJia)*e+6;u.push({x:t,y:i,label:"狙击",textColor:this.dbjjColor[1],rectColor:this.dbjjColor[2]})}break;case"QSZZ":if(x=this.indicsData[this.mIndics],x&&x[s.ShiJian]&&this.calCommonLinePoints(x[s.ShiJian],d,b,n,e,0,4,2),x&&x[s.ShiJian]){if(1===x[s.ShiJian][0]){let t=this.pixelPerWithSeparator*c+this.pixelPerWithSeparator/2-this.pixelPer/2+this.leftRangeWidth+this.pixelPer/2,i=(n-s.ZuiDiJia)*e;u.push({x:t,y:i,label:"B",textColor:this.qszzColor[0]})}else if(1===x[s.ShiJian][1]){let t=this.pixelPerWithSeparator*c+this.pixelPerWithSeparator/2-this.pixelPer/2+this.leftRangeWidth+this.pixelPer/2,i=(n-s.ZuiGaoJia)*e;u.push({x:t,y:i,label:"S",textColor:this.qszzColor[1],position:1})}1===x[s.ShiJian][2]?this.drawCandle(c,s.KaiPanJia,s.ShouPanJia,s.ZuiGaoJia,s.ZuiDiJia,!0):1===x[s.ShiJian][3]&&this.drawCandle(c,s.KaiPanJia,s.ShouPanJia,s.ZuiGaoJia,s.ZuiDiJia,!1)}}}));let C=this.maColor;if("MA"===this.mIndics?C=this.maColor:"BOLL"===this.mIndics?C=this.bollColor:"DBJJ"===this.mIndics?C=this.dbjjColor:"QSZZ"===this.mIndics&&(C=this.qszzColor),d.forEach(((t,i)=>{s.drawPath(t,C[i])})),("QSZZ"!==this.mIndics||this.qszzBSTag)&&u.forEach(((t,i)=>{let e=this.canvas.measureText(t.label,this.fontSize,this.fontFamily)+6,n=this.fontSize+8,s=t.x-e/2,o=t.y+2;t.rectColor&&this.canvas.drawRect(s,o,e,n,t.rectColor,1,t.rectColor);let a=this.fontSize+3;1===t.position&&(a=-this.fontSize/2),this.canvas.drawText(t.label,s+3,o+a,this.fontSize+1,this.fontFamily,t.textColor||"#FF0F0F")})),"MACD"===this.currentIndics?p.forEach(((t,i)=>{s.drawPath(t,this.macdColor[i])})):"KDJ"===this.currentIndics?C=this.kdjColor:"RSI"===this.currentIndics?C=this.rsiColor:"DMA"===this.currentIndics?C=this.dmaColor:"BIAS"===this.currentIndics?C=this.biasColor:"CCI"===this.currentIndics?C=this.cciColor:"W&R"===this.currentIndics?C=this.w8rColor:"DBJJ"===this.currentIndics&&(C=this.dbjjColor),f.forEach(((t,i)=>{s.drawPath(t,C[i])})),this.pressPoint){let{x:i}=this.pressPoint;if(i<=this.leftRangeWidth||i>=this.canvas.canvasWidth-this.rightRangeWidth)return;i-=this.leftRangeWidth;const e=parseInt(i/t,10);let n=this.data[e];if(n){this.drawXAxisGridLine(t*e+t/2+this.leftRangeWidth,this.formatXAxisLabel(n.time,!0,c),this.pointerLineColor,void 0,!0,!0,this.pointerTickColor);const i=this.candleYPixelRadio*(this.max-n.ShouPanJia);i<this.candleChartHeight&&i>0&&this.drawYAxisGridLine(i,n.ShouPanJia,this.pointerLineColor,i>this.candleChartHeight/2?"top":"bottom",!0,this.pointerTickColor,this.pricePrecision),n=this.getIndicatorSliceData(n),this.longTap(n,"kline")}}}getIndicatorSliceData(t){if("NONE"!==this.currentIndics&&"VOL"!==this.currentIndics){let i=this.indicsData[this.currentIndics];if(i&&i[t.ShiJian]){let e=i[t.ShiJian],n=JSON.parse(JSON.stringify(e)),s={};if(s[this.currentIndics]=n,t=Object.assign({},t,s),"DBJJ"===this.currentIndics&&i){let e=this.klineTimes.indexOf(1e3*t.ShiJian);if(e>=1){let n=this.klineTimes[e-1]/1e3;if(n){let e=i[n];t&&e&&(t["Pre"+this.currentIndics]=JSON.parse(JSON.stringify(e)))}}}}}if("NONE"!==this.mIndics){let i=this.indicsData[this.mIndics];if(i&&i[t.ShiJian]){let e=i[t.ShiJian],n=JSON.parse(JSON.stringify(e)),s={};s[this.mIndics]=n,t=Object.assign({},t,s)}if("QSZZ"===this.mIndics&&i){let e=this.klineTimes.indexOf(1e3*t.ShiJian);if(e>=1){let n=this.klineTimes[e-1]/1e3;if(n){let e=i[n];t&&e&&(t["Pre"+this.mIndics]=JSON.parse(JSON.stringify(e)))}}}}return t}getLastIndicatorData(){let t=this.data[this.data.length-1];return t?this.getIndicatorSliceData(t):null}calCommonLinePoints(t,i,e,n,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7?arguments[7]:void 0;h=h?h+a:t.length;for(let r=a,c=h;r<c;r++){i[r]||(i[r]=[]);let a=(n-t[r])*s+o;i[r].push([e,a])}}calMACDPoints(t,i,e,n,s){for(let o=0,a=t.length;o<a;o++)if(o<2){let a;i[o]||(i[o]=[]),t[o]>0?a=(s-t[o])*this.indicsYPixelRadio+n:0===t[o]?a=s*this.indicsYPixelRadio+n:t[o]<0&&(a=(s-t[o])*this.indicsYPixelRadio+n),i[o].push([e,a])}}drawTooltip(t){let i=50+this.leftRangeWidth;const e=this.fontSize,n=e+2,o=this.getColor(this.isUp(t.KaiPanJia,t.ShouPanJia,t.lastClose));[{label:"日期:".concat(this.formatXAxisLabel(t.time,!0)),labelColor:"#555555"},{label:"开:".concat(s.formatStockText(t.KaiPanJia,2))},{label:"收:".concat(s.formatStockText(t.ShouPanJia,2))},{label:"高:".concat(s.formatStockText(t.ZuiGaoJia,2))},{label:"低:".concat(s.formatStockText(t.ZuiDiJia,2))},{label:"涨跌:".concat(s.formatStockText((t.ShouPanJia-t.lastClose)/t.lastClose,2,"%")),labelColor:this.getColor(t.ShouPanJia>=t.lastClose)},{label:"量:".concat(s.formatStockText(t.ChengJiaoLiang,2,"K/M"))}].forEach((t=>{let{label:s,labelColor:a=o}=t;this.canvas.drawText(s,i,n,e,this.fontFamily,a),i+=this.canvas.measureText(s,e,this.fontFamily)+10}))}drawBackground(){super.drawBackground();const t=this.max,i=this.min;this.drawYAxisGridLine(0,t,void 0,"bottom",void 0,void 0,this.pricePrecision),this.drawYAxisGridLine(this.candleChartHeight,i,void 0,void 0,void 0,void 0,this.pricePrecision);for(let e=1;e<this.horizLineCount;e++)this.drawYAxisGridLine(this.candleChartHeight*(e/this.horizLineCount),t-(t-i)*(e/this.horizLineCount),void 0,"center",void 0,void 0,this.pricePrecision,"dashed");switch(this.currentIndics){case"VOL":this.drawYAxisGridLine(this.canvas.canvasHeight,"0",void 0,void 0,void 0,void 0,this.volPrecision),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight/2,this.maxVolume/2,void 0,void 0,void 0,void 0,this.volPrecision,"dashed"),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight,this.maxVolume,null,"bottom",void 0,void 0,this.volPrecision);break;case"MACD":let t=Math.max(Math.abs(this.maxIndics),Math.abs(this.minIndics));this.drawYAxisGridLine(this.canvas.canvasHeight,-t,void 0,void 0,void 0,void 0,2),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight,t,null,"bottom",void 0,void 0,2),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight/2,"0",void 0,"center",void 0,void 0,2);break;case"KDJ":case"RSI":case"DMA":case"BIAS":case"CCI":case"W&R":case"DBJJ":this.drawYAxisGridLine(this.canvas.canvasHeight,this.minIndics||0,void 0,void 0,void 0,void 0,2),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight/2,(this.minIndics+this.maxIndics)/2,void 0,void 0,void 0,void 0,2,"dashed"),this.drawYAxisGridLine(this.canvas.canvasHeight-this.indicsChartHeight,this.maxIndics,null,"bottom",void 0,void 0,2)}}getPoint(t,i){if(i>this.max||i<this.min)return null;let e=this.klineTimes.indexOf(t);return-1===e?null:{x:this.pixelPerWithSeparator*e+this.pixelPerWithSeparator/2-this.pixelPer/2+this.leftRangeWidth+this.pixelPer/2,y:this.candleYPixelRadio*(this.max-i)}}getLowPricePoint(t){let i=this.klineTimes.indexOf(t);if(-1===i)return null;let e=this.data[i];return e?{x:this.pixelPerWithSeparator*i+this.pixelPerWithSeparator/2-this.pixelPer/2+this.leftRangeWidth+this.pixelPer/2,y:this.candleYPixelRadio*(this.max-e.ZuiDiJia)}:null}drawChartExtend(){super.drawChartExtend()}drawCandle(t,i,e,n,s,o){const a=this.pixelPer,h=this.pixelPerWithSeparator*t+this.pixelPerWithSeparator/2-a/2+this.leftRangeWidth,r=this.candleYPixelRadio*(this.max-i);let c=i===e?1:this.candleYPixelRadio*(this.max-e)-r;c=Math.abs(c)<1?Math.sign(c):c;const l=this.getColor(o);a>1&&this.canvas.drawRect(h,r,a,c,l);const d=h+a/2,u=this.candleYPixelRadio*(this.max-n),p=this.candleYPixelRadio*(this.max-s);this.canvas.drawLine(d,u,d,p,1,l)}drawVolume(t,i,e){const n=this.pixelPer,s=this.pixelPerWithSeparator*t+this.pixelPerWithSeparator/2-n/2+this.leftRangeWidth,o=this.canvas.canvasHeight,a=-this.volumeYPixelRadio*i;this.canvas.drawRect(s,o,n,a,this.getColor(e))}drawMACDStick(t,i,e){const n=this.pixelPerWithSeparator*t+this.pixelPerWithSeparator/2-.5+this.leftRangeWidth,s=e+this.indicsChartHeight/2;let o,a;o=i>=0,a=-this.indicsYPixelRadio*i,this.canvas.drawRect(n,s,1,a,this.getColor(o))}panMove(t,i,e,n){if(!this.loading)if(t)this.pressPoint={x:i,y:e},this.redraw();else if(this.pressPoint)this.pressPoint=null,this.redraw();else{let t=Math.round(n/this.pixelPerWithSeparator);if("number"==typeof t&&0!==t)return this.reCalculate(t),!0}return!1}pinchMove(t){if(!this.loading){let i=this.data.length;try{let e=5;let n=1;n=i>210?25:i>180?18:i>160?16:i>140?14:i>120?12:i>100?10:i>60?2:1,t>1?(e=Math.ceil(t*n),i-=e):t<1&&(e=Math.ceil(1/t*n),i+=e)}catch(e){t>1?i=this.data.length-5:t<1&&(i=this.data.length+5)}return this.reCalculate(0,i),!0}return!1}}class l extends a{initData(){super.initData(),this.data=this.options.data||[],this.cache=[].concat(this.data),this.period=this.options.period||"1min",this.split=void 0!==this.options.split?this.options.split:1,this.position=0,this.hasMoreData=!0,this.reCalculate(0,this.options.initCount||240),this.initSubscribe()}initSubscribe(){let t={period:this.period,split:this.split,start:-1};this.dataProvider.subscribeKline(t,(t=>{if(t.length>0){const i=t[0];this.cache.length>0&&(this.cache[this.cache.length-1]=i),this.reCalculate()}}))}redraw(){this.data&&super.redraw()}initChart(){super.initChart();let t=this.data.length,i=this.mainChartWidth/t,e=Math.max(2*i/3,.5);i<1?(i=1,t=this.mainChartWidth,this.data=this.data.slice(0,t)):e>50&&(i=90,e=60),this.pixelPer=e,this.pixelPerWithSeparator=i;const n=Number.MAX_VALUE,s=Number.MIN_VALUE;let o=n,a=0,h=0;this.data.forEach((t=>{a=Math.max(a,t.ZuiGaoJia||s),o=Math.min(o,t.ZuiDiJia||n),h=Math.max(h,t.ChengJiaoLiang)})),this.max=a>o?a+.1*(a-o):1.1*a,this.min=a>o?o-.1*(a-o):.9*a,0===this.split&&this.min<0&&(this.min=0),this.maxVolume=h,this.candleChartHeight=this.mainChartHeight,this.candleYPixelRadio=this.candleChartHeight/(this.max-this.min),this.volumeYPixelRadio=this.indicsChartHeight/h}reCalculate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;const e=this.cache.length;let n=0,s=this.data.length,o=this.position;if(t>0)o<t?this.hasMoreData?n=t-o:o=0:o-=t;else if(t<0){const i=e-o-s;o+=i>-t?-t:i}if(i<s)o+=Number.parseInt((s-i)/2,10),s=i;else if(i>s){let t=Number.parseInt((i-s)/2,10);t+=Math.max(t-(e-o-s),0),o<t&&this.hasMoreData?n=t-o:(o=Math.max(o-t,0),s=i)}if(n>0){n+=s||n;const o=-(n+e);this.loadMoreData(o,n).then((()=>{this.reCalculate(t,i)}))}else this.data=this.cache.slice(o,o+s),this.position=o,this.redraw()}loadMoreData(t,i){this.loading=!0,this.canvas&&this.canvas.toggleMask(!0);const e=this.dataProvider;return this.dataProvider.getKline({period:this.period,split:this.split,start:t,count:i}).then((t=>{if(t&&e===this.dataProvider){const i=this.cache[0]?this.cache[0].ShiJian:Number.MAX_VALUE;let e;for(let n=t.length;n>0;n-=1)e=t[n-1],e.ShiJian<i?(this.cache.unshift(e),this.position+=1):this.hasMoreData=!1}this.loading=!1,this.redraw()}))}formatXAxisLabel(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=new Date(t);return i?s.formatDate(e,"yyyy-MM-dd hh:mm"):s.formatDate(e,"hh:00")}isUp(t,i,e){return t!==i?i>t:i>e}drawChart(){const t=[],i=this.pixelPerWithSeparator,e=this.pixelPer/2,n="VOL"===this.currentIndics,s=this.candleYPixelRadio,o=this.max;let a,h,r=0;if(this.data.forEach(((c,l)=>{let d=c.lastClose;if(d||(d=c.lastClose=l>0?this.data[l-1].ShouPanJia:0,c.time=1e3*c.ShiJian,c.isUp=this.isUp(c.KaiPanJia,c.ShouPanJia,d),c.xAxisLabel=this.formatXAxisLabel(c.time)),h=c.xAxisLabel,h!==a&&(a=h,(l-r)*i>55*this.canvas.pixelRadio)){let t=0!==l&&l!==this.data.length-1;this.drawXAxisGridLine(i*l+e+this.leftRangeWidth,h,void 0,void 0,void 0,void 0,void 0,t,"dashed"),r=l}n&&this.drawVolume(l,c.ChengJiaoLiang,c.isUp);let u=i*l+e+this.leftRangeWidth;0===l?u-=e:l===this.data.length-1&&(u+=e),t.push([u,s*(o-c.ShouPanJia)])})),this.canvas.fillPath(t,this.mainChartHeight,this.minLineColor,this.minFillColor,2),this.pressPoint){let{x:t}=this.pressPoint;if(t<=this.leftRangeWidth||t>=this.canvas.canvasWidth-this.rightRangeWidth)return;t-=this.leftRangeWidth;const e=parseInt(t/i,10),n=this.data[e];if(!n)return;this.drawXAxisGridLine(i*e+i/2+this.leftRangeWidth,this.formatXAxisLabel(n.time,!0),this.pointerLineColor,void 0,!0,!0,this.pointerTickColor);const a=s*(o-n.ShouPanJia);a<this.candleChartHeight&&a>0&&this.drawYAxisGridLine(a,n.ShouPanJia,this.pointerLineColor,a>this.candleChartHeight/2?"top":"bottom",!0,this.pointerTickColor,this.pricePrecision),this.longTap(n,"kline2")}}drawBackground(){super.drawBackground();const t=this.max,i=this.min;this.drawYAxisGridLine(0,t,void 0,"bottom",void 0,void 0,this.pricePrecision),this.drawYAxisGridLine(this.candleChartHeight,i,void 0,void 0,void 0,void 0,this.pricePrecision);for(let e=1;e<this.horizLineCount;e++)this.drawYAxisGridLine(this.candleChartHeight*(e/this.horizLineCount),t-(t-i)*(e/this.horizLineCount),void 0,"center",void 0,void 0,this.pricePrecision,"dashed");"VOL"===this.currentIndics&&(this.drawYAxisGridLine(this.canvas.canvasHeight,"0",void 0,void 0,void 0,void 0,this.volPrecision),this.drawYAxisGridLine(this.canvas.canvasHeight-this.volumeChartHeight,this.maxVolume,null,"bottom",void 0,void 0,this.volPrecision))}drawChartExtend(){}drawVolume(t,i,e){const n=this.pixelPer,s=this.pixelPerWithSeparator*t+this.pixelPerWithSeparator/2-n/2+this.leftRangeWidth,o=this.canvas.canvasHeight,a=-this.volumeYPixelRadio*i;this.canvas.drawRect(s,o,n,a,this.getColor(e))}panMove(t,i,e,n){if(!this.loading)if(t)this.pressPoint={x:i,y:e},this.redraw();else if(this.pressPoint)this.pressPoint=null,this.redraw();else{let t=Math.round(n/this.pixelPerWithSeparator);if("number"==typeof t&&0!==t)return this.reCalculate(t),!0}return!1}}function d(){}const u=6e4,p=864e5,f=["MA","BOLL","MACD","KDJ","RSI","DMA","BIAS","CCI","W&R"],m=function(){const t=new Date,i=[t.getFullYear(),"0".concat(t.getMonth()+1).slice(-2),"0".concat(t.getDate()).slice(-2)].join("");return{RiQi:i,JiaoYiShiJianDuan:[{KaiShiShiJian:930,JieShuShiJian:1130,KaiShiRiQi:i,JieShuRiQi:i},{KaiShiShiJian:1300,JieShuShiJian:1500,KaiShiRiQi:i,JieShuRiQi:i}],JiHeJingJiaDianShu:15,ShiQu:8,ZuoShou:0}}(),g=function(t,i,e){const n=String(t),s=parseInt(n.substr(0,4),10),o=parseInt(n.substr(4,2),10)-1,a=parseInt(n.substr(6,2),10),h=parseInt(Number(i)/100,10)-e,r=i%100;return Date.UTC(s,o,a,h,r)};class v{constructor(t,i,e,n,s){this.dzhyun=i,this.huilv=e,this.showPrefix=s,this.volTradeUnit=n,this.params=t}getKline(t){return this.dzhyun.query("/quote/kline",Object.assign({},this.params,t)).then((t=>{if(t[0]&&t[0].Data){let i=t[0].Data;return i.forEach((t=>{t.KaiPanJia=t.KaiPanJia*this.huilv,t.ShouPanJia=t.ShouPanJia*this.huilv,t.ZuiDiJia=t.ZuiDiJia*this.huilv,t.ZuiGaoJia=t.ZuiGaoJia*this.huilv,t.ChengJiaoLiang=t.ChengJiaoLiang/this.volTradeUnit,t.lastClose&&(t.lastClose=t.lastClose*this.huilv)})),i}return[]}))}subscribeKline(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;this.cancel(),this.klineDataStore=this.dzhyun.subscribe("/quote/kline",Object.assign({},this.params,t),(t=>{if(!(t instanceof Error)){let e=t[0]&&t[0].Data;e&&(e.forEach((t=>{t.KaiPanJia=t.KaiPanJia*this.huilv,t.ShouPanJia=t.ShouPanJia*this.huilv,t.ZuiDiJia=t.ZuiDiJia*this.huilv,t.ZuiGaoJia=t.ZuiGaoJia*this.huilv,t.ChengJiaoLiang=t.ChengJiaoLiang/this.volTradeUnit,t.lastClose&&(t.lastClose=t.lastClose*this.huilv)})),i(e))}}))}getMA(t){return this.dzhyun.query("/indicator/calc",Object.assign({},this.params,t,{name:"MA",text:"MA1:MA(CLOSE,P1);MA2:MA(CLOSE,P2);MA3:MA(CLOSE,P3);MA4:MA(CLOSE,P4);",parameter:"P1=5,P2=10,P3=30,P4=60"})).then((t=>{if(t[0]&&t[0].ShuJu){let i=t[0].ShuJu;for(let t=0,e=i.length;t<e;t++){let e=i[t].JieGuo;e.forEach(((t,i)=>{e[i]=t*this.huilv}))}return i}return[]})).catch((()=>[]))}getIndicatorData(t){let i="/indicator/calc";return-1===f.indexOf(t.name)&&(i="/indicator/calc/new"),this.dzhyun.query(i,Object.assign({},this.params,t)).then((t=>t[0]&&t[0].ShuJu?t[0].ShuJu:[])).catch((()=>[]))}_initMinCache(t){const i=t.JiaoYiShiJianDuan,e=t.ShiQu||8;this.minCache={lastClose:t.ZuoShou,ZuoShou:t.ZuoShou,ShiQu:e};let n=[];i&&i.length>0&&(n=this.calMinTimes(i,e,t.JiHeJingJiaDianShu||0)),this.minCache.minTimes=n}subscribeMin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;this.cancel();let i=Object.assign({},this.params);if(this.minCache&&this.minCache.currentTime){let t=s.formatDate(1e3*this.minCache.currentTime,"yyyyMMdd-hhmmss")+"-000-".concat(this.minCache.ShiQu);i.begin_time=t}this.minDataStore=this.dzhyun.subscribe("/quote/min",i,(i=>{if(i&&!(i instanceof Error)&&i.length>0){let e=i[0];if(1===e.QingPan&&(this.minCache=null),this.minCache||this._initMinCache(e.JiaoYiShiJianDuan?e:m),this.minCache&&this.minCache.ZuoShou&&(this.minCache.lastClose=this.minCache.ZuoShou*this.huilv),e=e.Data,e&&e.length>0){e.forEach((t=>{const i=1e3*t.ShiJian,e=t.ChengJiaoJia*this.huilv;this.updateMinCache(this.minCache,this.minCache.minTimes,i,t,e)}));const t=e[e.length-1].ShiJian;t&&(this.minCache.currentTime=t)}t(this.minCache)}}))}calMinTimes(t,i){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=[];if(t&&t.length>0){let s,o,a=0;const h=t.length-1;if(this.minCache.timeIntervalPoints=[],t.forEach(((t,e)=>{for(s=g(t.KaiShiRiQi,t.KaiShiShiJian,i),o=g(t.JieShuRiQi,t.JieShuShiJian,i),o<s&&(o+=p),s<a&&(s+=p,o+=p),e>0&&(s+=u);s<=o;)n.push(s),s+=u;a=o,e<h&&this.minCache.timeIntervalPoints.push(o)})),this.showPrefix){const t=e;s=n[0];for(let i=1;i<=t;i+=1)n.unshift(s-i*u)}}return n}_initMultiMinCache(t){const i=t.JiaoYiShiJianDuan,e=t.ShiQu||8;this.multiMinCache={lastClose:t.ZuoShou,ZuoShou:t.ZuoShou,ShiQu:e};let n=[];if(t.LiShiFenShi&&t.LiShiFenShi.length>0){const i=t.LiShiFenShi;let s,o;for(let t=0,a=i.length;t<a;t++){let a=[];s=i[t],o=s.Rows,s.JiaoYiShiJianDuan&&(a=this.calMinTimes(s.JiaoYiShiJianDuan,e)),a.length>0&&o&&o.length>0&&o.forEach((t=>{const i=1e3*t.ShiJian,e=t.ChengJiaoJia*this.huilv;this.updateMinCache(this.multiMinCache,a,i,t,e)})),n=n.concat(a)}}if(i&&i.length>0){let s=this.calMinTimes(i,e,t.JiHeJingJiaDianShu||0);const o=t.Data;if(s.length>0&&o&&o.length>0){o.forEach((t=>{const i=1e3*t.ShiJian,e=t.ChengJiaoJia*this.huilv;this.updateMinCache(this.multiMinCache,s,i,t,e)}));const t=o[o.length-1].ShiJian;t&&(this.multiMinCache.currentTime=t)}n=n.concat(s)}this.multiMinCache.minTimes=n}updateMinCache(t,i,e,n,s){let o=i.indexOf(e);n.ChengJiaoJia=s,n.ChengJiaoLiang=n.ChengJiaoLiang/this.volTradeUnit,o>=0&&(t[e]=n)}subMultiMin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cancel();let e=Object.assign({},this.params,i);if(this.multiMinCache&&this.multiMinCache.currentTime){let t=s.formatDate(1e3*this.multiMinCache.currentTime,"yyyyMMdd-hhmmss")+"-000-".concat(this.multiMinCache.ShiQu);e.begin_time=t}this.multiMinDataStore=this.dzhyun.subscribe("/quote/min",e,(i=>{if(i&&!(i instanceof Error)&&i.length>0){let e=i[0];if(1===e.QingPan&&(this.multiMinCache=null),this.multiMinCache){if(e=e.Data,e&&e.length>0){e.forEach((t=>{const i=1e3*t.ShiJian,e=t.ChengJiaoJia*this.huilv;this.updateMinCache(this.multiMinCache,this.multiMinCache.minTimes,i,t,e)}));const t=e[e.length-1].ShiJian;t&&(this.multiMinCache.currentTime=t)}}else this._initMultiMinCache(e.JiaoYiShiJianDuan?e:m);this.multiMinCache&&this.multiMinCache.ZuoShou&&(this.multiMinCache.lastClose=this.multiMinCache.ZuoShou*this.huilv),t(this.multiMinCache)}}))}cancel(){this.klineDataStore&&(this.klineDataStore.cancel(),this.klineDataStore=null),this.minDataStore&&(this.minDataStore.cancel(),this.minDataStore=null),this.multiMinDataStore&&(this.multiMinDataStore.cancel(),this.multiMinDataStore=null)}}const C={longTapTime:600},x=Math.abs;class b{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.target="string"==typeof t?document.querySelector(t):t,this._start=this._start.bind(this),this._move=this._move.bind(this),this._end=this._end.bind(this),this._cancel=this._cancel.bind(this),this.target.addEventListener("touchstart",this._start,!1),this.target.addEventListener("touchmove",this._move,!1),this.target.addEventListener("touchend",this._end,!1),this.target.addEventListener("touchcancel",this._cancel,!1),this._init(),this.handles={},this.option=Object.assign({},C,i)}_init(){this.touch={},this.movetouch={},this.isLongTap=!1,this.preVector={x:0,y:0},this.params={zoom:1,deltaX:0,direction:""}}_start(t){this._cancelTouchEnd(),this._cancelLongTap();let i=t.touches?t.touches[0]:t,e=Date.now();if(this.touch.startX=i.pageX,this.touch.startY=i.pageY,this.touch.startTime=e,t.touches.length>1){let i=t.touches[1];this.preVector={x:i.pageX-this.touch.startX,y:i.pageY-this.touch.startY}}else this.longTapTimeout=window.setTimeout((()=>{this.isLongTap=!0,this._emit("longTap",t)}),~~this.option.longTapTime)}_move(t){this._cancelLongTap(),this._cancelTouchEnd();let i=!1,e=t.touches?t.touches[0]:t;if(t.touches.length>1)if(i=!0,this.isLongTap)this._emit("longTap",t);else{let i=t.touches[1],n={x:i.pageX-e.pageX,y:i.pageY-e.pageY};this.preVector.x&&n.x&&(this.params.zoom=this.calcLen(n)/this.calcLen(this.preVector),this._emit("pinch",t)),this.preVector.x=n.x,this.preVector.y=n.y}else{if(this.isLongTap)i=!0,this._emit("longTap",t);else{if(this.movetouch.x||this.movetouch.y){let t=~~(e.pageX-(this.movetouch.x||0)),n=~~(e.pageY-(this.movetouch.y||0));x(t)<x(n)?this.params.direction=n<0?"up":"down":(i=!0,this.params.direction=t<0?"left":"right")}"left"!==this.params.direction&&"right"!==this.params.direction||(this.movetouch.x?this.params.deltaX=e.pageX-this.movetouch.x:this.params.deltaX=0,this._emit("move",t))}this.movetouch.x=e.pageX,this.movetouch.y=e.pageY}i&&t.preventDefault()}_end(t){this._touchEnd(t)}_cancel(t){this._touchEnd(t)}_touchEnd(t){if(this.isLongTap)this.touchEndTimeout=window.setTimeout((()=>{this._emit("end",t),this._init()}),1500);else{let i=!1;if(t.touches&&t.touches.length>0)i=!1;else{if(Date.now()-this.touch.startTime<=300)if(void 0===this.movetouch.x&&void 0===this.movetouch.y)i=!0;else{let t=~~((this.movetouch.x||0)-this.touch.startX),e=~~((this.movetouch.y||0)-this.touch.startY);const n=void 0!==this.movetouch.x&&x(t)<=30,s=void 0!==this.movetouch.y&&x(e)<=30;n&&s&&(i=!0)}}this.handleTouchEnd(t),i&&this._emit("tap",t)}}handleTouchEnd(t){this._cancelLongTap(),this._emit("end",t),this._init()}_emit(t,i){this.handles[t]&&"function"==typeof this.handles[t]&&this.handles[t].call(this.target,i,JSON.parse(JSON.stringify(this.params)))}_cancelLongTap(){this.longTapTimeout&&(window.clearTimeout(this.longTapTimeout),this.longTapTimeout=null)}_cancelTouchEnd(){this.touchEndTimeout&&(window.clearTimeout(this.touchEndTimeout),this.touchEndTimeout=null)}cancelAll(){this._cancelLongTap(),this._cancelTouchEnd()}calcLen(t){return Math.sqrt(t.x*t.x+t.y*t.y)}on(t,i){this.handles[t]=i}off(t){this.handles[t]=null}destroy(){return this.cancelAll(),this.target.removeEventListener("touchstart",this._start),this.target.removeEventListener("touchmove",this._move),this.target.removeEventListener("touchend",this._end),this.target.removeEventListener("touchcancel",this._cancel),this.isLongTap=!1,this.params=this.handles=this.movetouch=this.touch=this.preVector=null,!1}}const y={longTapTime:600},w=Math.abs;class S{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.target="string"==typeof t?document.querySelector(t):t,this._start=this._start.bind(this),this._move=this._move.bind(this),this._end=this._end.bind(this),this._pinch=this._pinch.bind(this),this._leave=this._leave.bind(this),this.target.addEventListener("mousedown",this._start,!1),this.target.addEventListener("mousemove",this._move,!1),this.target.addEventListener("mouseup",this._end,!1),this.target.addEventListener("mouseleave",this._leave,!1),this.addMouseWheelEvent(),this._init(),this.handles={},this.option=Object.assign({},y,i)}on(t,i){this.handles[t]=i}off(t){this.handles[t]=null}_emit(t,i){this.handles[t]&&"function"==typeof this.handles[t]&&this.handles[t].call(this.target,i,JSON.parse(JSON.stringify(this.params)))}_init(){this.touch={},this.movetouch={},this.isLongTap=!1,this.mouseIsPress=!1,this.params={zoom:1,deltaX:0,direction:""}}_start(t){this._cancelTouchEnd(),t.touches=[],t.touches.push(t);let i=Date.now();this.touch.startX=t.pageX,this.touch.startY=t.pageY,this.touch.startTime=i,this.mouseIsPress=!0,this._emit("end",t)}_move(t){if(t.touches=[],t.touches.push(t),this.mouseIsPress){if(this.isLongTap=!1,this.movetouch.x||this.movetouch.y){let i=~~(t.pageX-(this.movetouch.x||0)),e=~~(t.pageY-(this.movetouch.y||0));w(i)<w(e)?this.params.direction=e<0?"up":"down":this.params.direction=i<0?"left":"right"}"left"!==this.params.direction&&"right"!==this.params.direction||(this.movetouch.x?this.params.deltaX=t.pageX-this.movetouch.x:this.params.deltaX=0,0!==this.params.deltaX&&this._cancelTouchEnd(),this._emit("move",t))}this.movetouch.x=t.pageX,this.movetouch.y=t.pageY,this.mouseIsPress||(this.isLongTap=!0,this._emit("longTap",t),this._cancelTouchEnd(),this.touchEndTimeout=window.setTimeout((()=>{this._emit("end",t),this._init()}),1500))}_end(t){t.touches=[],t.touches.push(t);let i=!1;if(Date.now()-this.touch.startTime<=300)if(void 0===this.movetouch.x&&void 0===this.movetouch.y)i=!0;else{let t=~~((this.movetouch.x||0)-this.touch.startX),e=~~((this.movetouch.y||0)-this.touch.startY);const n=void 0!==this.movetouch.x&&w(t)<=30,s=void 0!==this.movetouch.y&&w(e)<=30;n&&s&&(i=!0)}this.handleTouchEnd(t),i&&this._emit("tap",t)}_pinch(t){this._emit("end",t),t.preventDefault(),"mousewheel"===this.support?t.wheelDelta<0?this.params.zoom=1.001:this.params.zoom=.999:"DOMMouseScroll"===this.support&&(t.detail>0?this.params.zoom=1.001:this.params.zoom=.999),this._emit("pinch",t)}_leave(t){t.touches=[],t.touches.push(t),this.handleTouchEnd(t)}addMouseWheelEvent(){"object"==typeof this.target.onmousewheel?(this.support="mousewheel",this.target.addEventListener("mousewheel",this._pinch,!1)):void 0===this.target.onmousewheel?(this.support="DOMMouseScroll",this.target.addEventListener("DOMMouseScroll",this._pinch,!1)):this.support=""}removeMouseWheelEvent(){"mousewheel"===this.support?this.target.removeEventListener("mousewheel",this._pinch):"DOMMouseScroll"===this.support&&this.target.removeEventListener("DOMMouseScroll",this._pinch),this.support=""}_cancelLongTap(){this.longTapTimeout&&(window.clearTimeout(this.longTapTimeout),this.longTapTimeout=null)}_cancelTouchEnd(){this.touchEndTimeout&&(window.clearTimeout(this.touchEndTimeout),this.touchEndTimeout=null)}handleTouchEnd(t){this._emit("end",t),this._init()}cancelAll(){this._cancelLongTap(),this._cancelTouchEnd()}destroy(){return this.cancelAll(),this.target.removeEventListener("mousedown",this._start),this.target.removeEventListener("mousemove",this._move),this.target.removeEventListener("mouseup",this._end),this.target.removeEventListener("mouseleave",this._leave),this.removeMouseWheelEvent(),this.isLongTap=!1,this.mouseIsPress=!1,this.params=this.handles=this.movetouch=this.touch=this.preVector=null,!1}}function P(t){let i=t.getBoundingClientRect();return{width:Math.floor(i.width),height:Math.floor(i.height)}}const L=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","1","2","3","4","5","6","7","8","9","0"];var T={name:"mv-stockchart",data(){return{width:375,height:420,pixelRadio:2,id:"",isNotExcuteActive:!1}},props:{obj:{type:String,required:!0},chartType:{type:String,default:"min",validator:function(t){return-1!==["min","multi-min","kline2","1min","5min","15min","30min","60min","1day","week","month","season","halfyear","year"].indexOf(t)}},simplifiedMode:{type:Boolean,default:!1},klineMainIndics:{type:String,default:"NONE"},klineIndics:{type:String,default:"NONE"},days:{type:Number},pricePrecision:{type:Number,default:2},volPrecision:{type:Number,default:0},longTapTime:{type:Number,default:750},huilv:{type:Number,default:1},hasAvgPrice:{type:Boolean,default:!0},customInterval:{type:Number,default:60},doubleTapTime:{type:Number,default:0},upColor:{type:String,default:"#ee2c2c"},downColor:{type:String,default:"#1ca049"},pointerLineColor:{type:String,default:"#3e6ac5"},pointerTickColor:{type:String,default:"#ffffff"},gridLineColor:{type:String,default:"#d6d6d6"},tickColor:{type:String,default:"#333333"},tickBackgroundColor:{type:String,default:"#ffffff"},minLineColor:{type:String,default:"#3378dd"},minFillColor:{type:[String,Object],default:"rgba(164, 202, 255, 0.2)"},avgPriceColor:{type:String,default:"#ff8800"},maColor:{type:Array,default:function(){return["#e78512","#2e8ae6","#cc2996","#3e6ac5","#4ca92a","#d3141a"]}},bollColor:{type:Array,default:function(){return["#e78512","#2e8ae6","#cc2996"]}},macdColor:{type:Array,default:function(){return["#e78512","#2e8ae6"]}},kdjColor:{type:Array,default:function(){return["#e78512","#2e8ae6","#cc2996"]}},rsiColor:{type:Array,default:function(){return["#e78512","#2e8ae6","#cc2996"]}},dmaColor:{type:Array,default:function(){return["#e78512","#2e8ae6"]}},biasColor:{type:Array,default:function(){return["#e78512","#2e8ae6","#cc2996"]}},cciColor:{type:Array,default:function(){return["#e78512"]}},w8rColor:{type:Array,default:function(){return["#e78512","#2e8ae6"]}},dbjjColor:{type:Array,default:function(){return["#FF0F0F","#EEEEEE","#FF0F0F"]}},qszzColor:{type:Array,default:function(){return["#E61919","#1CA249","#1CA249","#E61919","#FF0000","#1A75F1"]}},qszzBSTag:{type:Boolean,default:!1},volTradeUnit:{type:Number,default:100},split:{type:Number,default:1},maCount:{type:Number,default:4},isMobileMode:{type:Boolean,default:!0},useEvent:{type:Boolean,default:!0},showPrefix:{type:Boolean,default:!0},horizLineCount:{type:Number,default:4},leftRangeWidth:{type:Number,default:0},rightRangeWidth:{type:Number,default:0},fontSize:{type:Number,default:12},fontFamily:{type:String,default:"Arial"},initKlineCount:{type:Number,default:80},chartExtend:{type:Array,default:null}},created(){this.klineChart={};const t=this.randomStr(6);this.id="canvas_".concat(t),this.debounceShowChart=function(t,i,e){let n;return function(){let s=this,o=arguments,a=e&&!n;window.clearTimeout(n),n=window.setTimeout((function(){n=null,e||t.apply(s,o)}),i),a&&t.apply(s,o)}}(this.showChart,15)},mounted(){this.isNotExcuteActive=!0,this.resizeFunc=function(t,i,e){let n,s=new Date;return function(){let o=this,a=arguments,h=new Date;window.clearTimeout(n),h-s>=e?(t.apply(o,a),s=h):n=window.setTimeout(t,i)}}(this.resizeHandle,200,1e3),window.addEventListener("resize",this.resizeFunc);let t=P(this.$refs.container);this.width=t.width,this.height=t.height,this.pixelRadio=window.devicePixelRatio?window.devicePixelRatio:2,this.$refs.canvas&&this.useEvent&&(this.isMobileMode?this.gesture=new b(this.$refs.canvas,{longTapTime:this.longTapTime}):this.gesture=new S(this.$refs.canvas,{longTapTime:this.longTapTime}),this.gesture.on("move",this.onMove.bind(this)),this.gesture.on("longTap",this.onLongTap.bind(this)),this.gesture.on("pinch",this.onPinch.bind(this)),this.gesture.on("end",this.onEnd.bind(this)),this.gesture.on("tap",this.onTap.bind(this)))},activated(){this.isNotExcuteActive?this.isNotExcuteActive=!1:this.loadChart()},deactivated(){this.init()},destroyed(){window.clearTimeout(this.delayTimeOut),window.removeEventListener("resize",this.resizeFunc),this.resizeFunc=null,this.init(),this.gesture&&this.gesture.destroy()},computed:{chartWidth(){return this.width*this.pixelRadio},chartHeight(){return this.height*this.pixelRadio}},watch:{obj(t,i){t!==i&&(this.isNotExcuteActive=!0,this.init(),this.loadChart())},width(t,i){t!==i&&(this.canvas&&(this.canvas.width=t),this.debounceShowChart())},height(t,i){t!==i&&(this.canvas&&(this.canvas.height=t),this.debounceShowChart())},chartType(t,i){t!==i&&(this.gesture&&this.gesture.handleTouchEnd(),this.debounceShowChart())},pricePrecision(t,i){t!==i&&this.debounceShowChart()},volPrecision(t,i){t!==i&&this.debounceShowChart()},huilv(t,i){t!==i&&(this.chartDataProvider&&(this.chartDataProvider.huilv=t),this.debounceShowChart())},showPrefix(t,i){t!==i&&(this.chartDataProvider&&(this.chartDataProvider.showPrefix=t),this.debounceShowChart())},volTradeUnit(t,i){t!==i&&(this.chartDataProvider&&(this.chartDataProvider.volTradeUnit=t),this.debounceShowChart())},split(t,i){t!==i&&this.debounceShowChart()},upColor(t,i){t!==i&&this.debounceShowChart()},downColor(t,i){t!==i&&this.debounceShowChart()},pointerLineColor(t,i){t!==i&&this.debounceShowChart()},pointerTickColor(t,i){t!==i&&this.debounceShowChart()},gridLineColor(t,i){t!==i&&this.debounceShowChart()},tickColor(t,i){t!==i&&this.debounceShowChart()},tickBackgroundColor(t,i){t!==i&&this.debounceShowChart()},avgPriceColor(t,i){t!==i&&this.debounceShowChart()},klineIndics(t,i){t!==i&&this.debounceShowChart()},klineMainIndics(t,i){t!==i&&this.debounceShowChart()},chartExtend(t,i){t!==i&&this.debounceShowChart()}},methods:{init(){this.chartDataProvider&&this.chartDataProvider.cancel(),this.chartDataProvider=null,this.canvas=null,this.minChart&&(this.minChart=null),this.multiMinChart&&(this.multiMinChart=null),this.kline2&&(this.kline2=null),this.klineChart={}},updateSize(){let t=P(this.$refs.container);t.height===this.height&&t.width===this.width||(this.width=t.width,this.height=t.height)},resizeHandle(){this.cleanTimer(),this.delayTimeOut=window.setTimeout((()=>{this.updateSize()}),30)},cleanTimer(){this.delayTimeOut&&(window.clearTimeout(this.delayTimeOut),this.delayTimeOut=null)},loadChart(){this.chartDataProvider=new v({obj:this.obj},this.$dzhyun,this.huilv,this.volTradeUnit,this.showPrefix),this.canvas=new t({pixelRadio:this.pixelRadio,canvasId:this.id,width:this.width,height:this.height}),this.debounceShowChart()},showChart(){let t;if("min"===this.chartType)this.minChart||(this.minChart=new h(this.chartDataProvider,{simplifiedMode:this.simplifiedMode,fontSize:this.fontSize,fontFamily:this.fontFamily,hasAvgPrice:this.hasAvgPrice,pricePrecision:this.pricePrecision,volPrecision:this.volPrecision,customInterval:this.customInterval,longTap:this.handleLongTap.bind(this),downColor:this.downColor,upColor:this.upColor,pointerLineColor:this.pointerLineColor,pointerTickColor:this.pointerTickColor,gridLineColor:this.gridLineColor,tickColor:this.tickColor,tickBackgroundColor:this.tickBackgroundColor,avgPriceColor:this.avgPriceColor,minLineColor:this.minLineColor,minFillColor:this.minFillColor,horizLineCount:this.horizLineCount,currentIndics:this.klineIndics,leftRangeWidth:this.leftRangeWidth,rightRangeWidth:this.rightRangeWidth,chartExtend:this.chartExtend})),t=this.minChart,t.hasAvgPrice=this.hasAvgPrice,t.avgPriceColor=this.avgPriceColor,t.minLineColor=this.minLineColor,t.minFillColor=this.minFillColor;else if("multi-min"===this.chartType)this.multiMinChart||(this.multiMinChart=new r(this.chartDataProvider,{days:this.days,fontSize:this.fontSize,fontFamily:this.fontFamily,hasAvgPrice:this.hasAvgPrice,pricePrecision:this.pricePrecision,volPrecision:this.volPrecision,customInterval:this.customInterval,longTap:this.handleLongTap.bind(this),downColor:this.downColor,upColor:this.upColor,pointerLineColor:this.pointerLineColor,pointerTickColor:this.pointerTickColor,gridLineColor:this.gridLineColor,tickColor:this.tickColor,tickBackgroundColor:this.tickBackgroundColor,avgPriceColor:this.avgPriceColor,minLineColor:this.minLineColor,minFillColor:this.minFillColor,horizLineCount:this.horizLineCount,currentIndics:this.klineIndics,leftRangeWidth:this.leftRangeWidth,rightRangeWidth:this.rightRangeWidth})),t=this.multiMinChart,t.hasAvgPrice=this.hasAvgPrice,t.avgPriceColor=this.avgPriceColor,t.minLineColor=this.minLineColor,t.minFillColor=this.minFillColor;else if("kline2"===this.chartType){let i=!1;this.kline2?this.kline2.split!==this.split&&(i=!0):i=!0,i&&(this.kline2=new l(this.chartDataProvider,{period:"1min",pricePrecision:this.pricePrecision,volPrecision:this.volPrecision,longTap:this.handleLongTap.bind(this),downColor:this.downColor,upColor:this.upColor,pointerLineColor:this.pointerLineColor,pointerTickColor:this.pointerTickColor,gridLineColor:this.gridLineColor,tickColor:this.tickColor,tickBackgroundColor:this.tickBackgroundColor,minLineColor:this.minLineColor,minFillColor:this.minFillColor,split:this.split,horizLineCount:this.horizLineCount,currentIndics:"VOL",leftRangeWidth:this.leftRangeWidth,rightRangeWidth:this.rightRangeWidth})),t=this.kline2,t.minLineColor=this.minLineColor,t.minFillColor=this.minFillColor}else{const i="klineChart".concat(this.chartType);let e=!1;this.klineChart[i]?(this.klineChart[i].split!==this.split&&(e=!0),this.klineChart[i].currentIndics!==this.klineIndics&&(this.klineChart[i].currentIndics=this.klineIndics,this.klineChart[i].initIndicator(this.klineIndics)),this.klineChart[i].mIndics!==this.klineMainIndics&&(this.klineChart[i].mIndics=this.klineMainIndics,this.klineChart[i].initIndicator(this.klineMainIndics))):e=!0,e&&(this.klineChart[i]=new c(this.chartDataProvider,{period:this.chartType,maxCount:240,minCount:20,fontSize:this.fontSize,fontFamily:this.fontFamily,pricePrecision:this.pricePrecision,volPrecision:this.volPrecision,longTap:this.handleLongTap.bind(this),downColor:this.downColor,upColor:this.upColor,pointerLineColor:this.pointerLineColor,pointerTickColor:this.pointerTickColor,gridLineColor:this.gridLineColor,tickColor:this.tickColor,tickBackgroundColor:this.tickBackgroundColor,maColor:this.maColor,macdColor:this.macdColor,kdjColor:this.kdjColor,rsiColor:this.rsiColor,dmaColor:this.dmaColor,bollColor:this.bollColor,biasColor:this.biasColor,cciColor:this.cciColor,w8rColor:this.w8rColor,dbjjColor:this.dbjjColor,qszzColor:this.qszzColor,qszzBSTag:this.qszzBSTag,maCount:this.maCount,split:this.split,horizLineCount:this.horizLineCount,mIndics:this.klineMainIndics,currentIndics:this.klineIndics,leftRangeWidth:this.leftRangeWidth,rightRangeWidth:this.rightRangeWidth,chartExtend:this.chartExtend,initCount:this.initKlineCount})),t=this.klineChart[i],t.maColor=this.maColor,t.macdColor=this.macdColor,t.kdjColor=this.kdjColor,t.rsiColor=this.rsiColor,t.dmaColor=this.dmaColor,t.bollColor=this.bollColor,t.biasColor=this.biasColor,t.cciColor=this.cciColor,t.w8rColor=this.w8rColor,t.dbjjColor=this.dbjjColor,t.qszzColor=this.qszzColor,t.qszzBSTag=this.qszzBSTag}t.volPrecision=this.volPrecision,t.pricePrecision=this.pricePrecision,t.upColor=this.upColor,t.downColor=this.downColor,t.pointerLineColor=this.pointerLineColor,t.pointerTickColor=this.pointerTickColor,t.gridLineColor=this.gridLineColor,t.tickColor=this.tickColor,t.tickBackgroundColor=this.tickBackgroundColor,t.chartExtend=this.chartExtend,this.canvas&&this.canvas.show(t),this.$emit("chart-showed")},handleContextMenu(t){t.preventDefault()},onMove(t,i){this.canvas.touchmove(t,i.deltaX)},onEnd(t){this.$emit("touchend"),this.canvas&&this.canvas.touchend()},onTap(t){this.$emit("tap")},onLongTap(t){this.canvas&&this.canvas.longtap(t)},onPinch(t,i){this.canvas.pinch(t,i.zoom)},handleLongTap(t,i){this.$emit("long-tap-select",t,i)},randomStr(t){let i=L.length,e="";for(let n=0;n<t;n++){let t=Math.floor(Math.random()*i);e+=L[t]}return e},getLastIndicatorData(){const t="klineChart".concat(this.chartType);let i=this.klineChart[t];return i?i.getLastIndicatorData():null}}};var M=function(t,i,e,n,s,o,a,h){var r,c="function"==typeof t?t.options:t;if(i&&(c.render=i,c.staticRenderFns=e,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(r=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=r):s&&(r=h?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),r)if(c.functional){c._injectStyles=r;var l=c.render;c.render=function(t,i){return r.call(i),l(t,i)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,r):[r]}return{exports:t,options:c}}(T,(function(){var t=this,i=t._self._c;return i("div",{ref:"container",staticStyle:{width:"100%",height:"100%"}},[i("canvas",{ref:"canvas",style:{width:t.width+"px",height:t.height+"px"},attrs:{id:t.id,pixelRadio:t.pixelRadio,width:t.chartWidth,height:t.chartHeight},on:{contextmenu:t.handleContextMenu}})])}),[],!1,null,null,null),k=M.exports;k.install=function(t){t.component(k.name,k)};var J=k;const E=[J],I=function(t){I.installed||E.map((i=>t.component(i.name,i)))};"undefined"!=typeof window&&window.Vue&&I(window.Vue);var A={install:I,StockChart:J}}(),exports.MvStockChart=n}();
//# sourceMappingURL=mv-stockchart.commonjs.min.js.map